<!doctype html><html lang=ko dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="헤드 퍼스트 디자인 패턴"><title>2. 옵저버 패턴</title><link rel=canonical href=https://codemario318.github.io/post/gof/2/><link rel=stylesheet href=/scss/style.min.cbce94e2760d14d60414e59d5a36ab2819232375817e010dbe7be2234b67da1b.css><meta property="og:title" content="2. 옵저버 패턴"><meta property="og:description" content="헤드 퍼스트 디자인 패턴"><meta property="og:url" content="https://codemario318.github.io/post/gof/2/"><meta property="og:site_name" content="Mario Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Common"><meta property="article:published_time" content="2023-09-27T13:09:08+09:00"><meta property="article:modified_time" content="2023-09-27T13:09:08+09:00"><meta property="og:image" content="https://codemario318.github.io/post/gof/2/cover.png"><meta name=twitter:title content="2. 옵저버 패턴"><meta name=twitter:description content="헤드 퍼스트 디자인 패턴"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codemario318.github.io/post/gof/2/cover.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-K99591YLGK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K99591YLGK",{anonymize_ip:!1})}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3183752545292673" crossorigin=anonymous></script><meta name=naver-site-verification content="2315bde85c86f66092140cc465c340a2170f3187"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu760fd15c5fbb2f30cf0868dc4a5dc41a_14271_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Mario Blog</a></h1><h2 class=site-description></h2></div></header><ol class=social-menu><li><a href=https://github.com/codemario318 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><ul class="menu sub-menu"><li><a href=/categories/backend/><span>Backend</span>
<span class=content-count>3</span></a></li><li><a href=/categories/cleancode/><span>Clean Code</span>
<span class=content-count>10</span></a></li><li><a href=/categories/common/><span>Common</span>
<span class=content-count>49</span></a></li><li><a href=/categories/data/><span>Data</span>
<span class=content-count>3</span></a></li><li><a href=/categories/db/><span>DB</span>
<span class=content-count>1</span></a></li><li><a href=/categories/frontend/><span>Frontend</span>
<span class=content-count>10</span></a></li><li><a href=/categories/golang/><span>GoLang</span>
<span class=content-count>13</span></a></li><li><a href=/categories/headfirstdesignpatterns/><span>헤드 퍼스트 디자인 패턴</span>
<span class=content-count>22</span></a></li><li><a href=/categories/infra/><span>Infra</span>
<span class=content-count>14</span></a></li><li><a href=/categories/problemsolving/><span>Problem Solving</span>
<span class=content-count>1</span></a></li><li><a href=/categories/project/><span>Project</span>
<span class=content-count>5</span></a></li><li><a href=/categories/realmysql/><span>Real MySQL</span>
<span class=content-count>53</span></a></li></ul><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#옵저버-패턴>옵저버 패턴</a><ol><li><a href=#옵저버-패턴의-정의>옵저버 패턴의 정의</a></li><li><a href=#옵저버-패턴의-구조>옵저버 패턴의 구조</a></li><li><a href=#느슨한-결합의-위력>느슨한 결합의 위력</a></li><li><a href=#풀-방식>풀 방식</a></li><li><a href=#디자인-원칙>디자인 원칙</a></li></ol></li><li><a href=#기상-모니터링-애플리케이션>기상 모니터링 애플리케이션</a><ol><li><a href=#요구-사항-분석>요구 사항 분석</a></li><li><a href=#구현-목표>구현 목표</a></li><li><a href=#가상-스테이션용-코드-추가>가상 스테이션용 코드 추가</a></li><li><a href=#원칙으로-추가-코드-살펴보기>원칙으로 추가 코드 살펴보기</a></li><li><a href=#기상-스테이션-설계하기>기상 스테이션 설계하기</a></li></ol></li><li><a href=#디자인-도구상자-안에-들어가야-할-도구들>디자인 도구상자 안에 들어가야 할 도구들</a></li><li><a href=#핵심-정리>핵심 정리</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/gof/2/><img src=/post/gof/2/cover_hu5fe9e632d31d6204170abf166c9a2927_244577_800x0_resize_box_3.png srcset="/post/gof/2/cover_hu5fe9e632d31d6204170abf166c9a2927_244577_800x0_resize_box_3.png 800w, /post/gof/2/cover_hu5fe9e632d31d6204170abf166c9a2927_244577_1600x0_resize_box_3.png 1600w" width=800 height=966 loading=lazy alt="Featured image of post 2. 옵저버 패턴"></a></div><div class=article-details><header class=article-category><a href=/categories/headfirstdesignpatterns/>헤드 퍼스트 디자인 패턴</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/gof/2/>2. 옵저버 패턴</a></h2><h3 class=article-subtitle>헤드 퍼스트 디자인 패턴</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2023/09/27</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>8 minute read</time></div></footer></div></header><section class=article-content><p>옵저버 패턴은 중요한 일이 일어났을 때 객체에게 새 소식을 알려 줄 수 있는 패턴이다.</p><p>일대 다 관계나 느슨한 결합같은 개념을 통해 구성되며 자주 사용되는 패턴 중 하나이다.</p><h2 id=옵저버-패턴>옵저버 패턴</h2><blockquote><p>옵저버 패턴은 주제(Subject), 옵저버(observer)로 구성된다.</p></blockquote><pre class=mermaid style=text-align:center>flowchart LR
  a((주제 객체))

  subgraph 옵저버 객체
    b((객체 1))
    c((객체 2))
    d((객체 3))
  end

  a-.->b
  a-.->c
  a-.->d
</pre><p>이 책에서는 옵저버 패턴을 신문 구독을 예시로 들고 있다.</p><ol><li>신문사가 신문을 찍어낸다.</li><li>독자가 특정 신문사에 구독 신청을 하면 구독 해지 전까지 새로운 신문이 나올 때마다 배달을 받을 수 있다.</li><li>신문을 보고싶지 않으면 구독 해지 신청을 한다.</li><li>신문사가 망하지 않는 이상 여러 구독자들은 신문을 구독하거나 해지하는 것을 반복한다.</li></ol><h3 id=옵저버-패턴의-정의>옵저버 패턴의 정의</h3><blockquote><p>옵저버 패턴은 일련의 객체 사이에서 일대다 관계를 정의하고, 한 객체의 상태가 변경되면 그 객체에 의존하는 모든 객체에 연락이 간다.</p></blockquote><p>옵저버 패턴은 한 객체의 상태가 바뀌면 그 객체에 의존하는 다른 객체에게 연락이 가고 자동으로 내용이 갱신되는 방식으로 일대다(one-two-many) 의존성을 정의한다.</p><ul><li>옵저버는 주제에 딸려 있으며 주제의 상태가 바뀌면 옵저버에게 정보가 전달된다.</li><li>보통 주제 인터페이스와 옵저버 인터페이스가 들어있는 클래스 디자인으로 구현한다.</li></ul><h3 id=옵저버-패턴의-구조>옵저버 패턴의 구조</h3><pre class=mermaid style=text-align:center>classDiagram
    direction LR
    class Subject {
      << interface >>  
      registerObserver()
      removeObserver()
      notifyObservers()
    }
    class Observer {
      << interface >>  
      update()
    }
    class ConcreteSubject {
      registerObserver()
      removeObserver()
      notifyObservers()
  
      getState()
      setState()
    }
    class ConcreteObserver {
      update()
    }

    Subject --> Observer : 옵저버
    
    ConcreteObserver ..> Observer
    
    ConcreteSubject <-- ConcreteObserver : 주제
    Subject <.. ConcreteSubject
</pre><ul><li>Subject<ul><li>주제를 나타내는 인터페이스로 객체에서 옵저버로 등록하거나 옵저버 목록에서 탈퇴하고 싶을 때 해당 인터페이스의 메소드를 사용한다.</li></ul></li><li>Observer<ul><li>옵저버가 될 가능성이 있는 객체는 만드시 Observer 인터페이스를 구현해야 한다.</li><li>주제의 상태가 바뀌었을 때 호출되는 <code>update()</code> 메소드로만 구성된다.</li></ul></li><li>ConcreteSubject<ul><li>주제 역할을 하는 구상 클래스는 항상 Subject 인터페이스를 구현해야 한다.</li><li>주제 클래스에는 등록 및 해지용 메소드와 상태가 바뀔 때마다 모든 옵저버에게 연락하는 <code>notifyObservers()</code> 메소드도 구현해야 한다.</li></ul></li><li>Concreteobserver<ul><li>Observer 인터페이스만 구현한다면 무엇이든 옵저버 클래스가 될 수 있다.</li><li>각 옵저버는 특정 주제에 등록해서 연략 받을 수 있다.</li></ul></li></ul><blockquote><p>출판-구독(publish-Subscribe) 패턴과의 차이점</p><p>출판-구독 패턴은 구독자가 서로 다른 유형의 메시지에 관심을 가질 수 있고, 출판사와 구독자를 더 세세하게 분리할 수 있는 복잡한 패턴이다.</p></blockquote><h3 id=느슨한-결합의-위력>느슨한 결합의 위력</h3><p>느슨한 결합(Loose Coupling)은 객체들이 상호작용할 수는 있지만, 서로 잘 모르는 관계를 의미한다.</p><ul><li>느슨한 결합을 활용하면 유연성이 좋아진다.</li><li>옵저버 패턴은 느슨한 결합의 좋은 예시이다.</li></ul><p><strong>옵저버 패턴의 느슨한 결합</strong></p><ul><li>주제는 옵저버가 특정 인터페이스(Observer)를 구현한다는 사실만 알고있다.</li><li>옵저버는 언제든지 추가할 수 있다.<ul><li>주제는 Observer 인터페이스를 구현하는 객체의 목록에만 의존하므로 엔제든지 새로운 옵저버를 추가할 수 있다.</li><li>실행 중에 하나의 옵저버를 다른 옵저버로 바꿔도 주제는 계속해서 다른 옵저버에게 데이터를 보낼 수 있다.</li></ul></li><li>새로운 형식의 옵저버를 추가할 때도 주제를 변경할 필요가 없다.<ul><li>새로운 옵저버 클래스를 추가할 때 변경 없이 Observer 인터페이스만 구현한다면 어떤 객체에도 연락할 수 있다.</li></ul></li><li>주제와 옵저버는 서로 독립적으로 재사용 할 수 있다.<ul><li>둘이 서로 단단하게 결합되어 있지 않기 때문에 손쉽게 재사용 할 수 있다.</li></ul></li><li>주제나 옵저버가 달라져도 서로에게 영향을 미치지는 않는다.<ul><li>느슨하게 결합되어 있으므로 주제나 옵저버 인터페이스를 구현한다는 조건만 만족한다면 어떻게 고쳐도 문제가 생기지 않는다.</li></ul></li></ul><blockquote><p>+디자인 원칙: 상호작용하는 객체 사이에는 가능하면 느슨한 결합을 사용해야 한다.</p><p>느슨하게 결합하는 디자인을 사용하면 상호의존성을 최소화 할 수 있기 때문에 변경 사항이 생겨도 무난히 처리할 수 있는 유연한 객체지향 시스템을 구축할 수 있다.</p></blockquote><h3 id=풀-방식>풀 방식</h3><p>기본적인 옵저버 패턴은 주제가 변경되었을 때 옵저버에게 알리는 방식(푸시)으로 처리되었다. 하지만 이러한 방식은 변경 반영이 필요없는 옵저버에게도 알리게 된다.</p><p>이러한 문제가 존재한다면 옵저버가 필요할 때마다 데이터를 끌어오는 풀 방식을 통해 개선될 수 있다.</p><p>값이 변했다는 알림을 옵저버가 받았을 때 주제에 있는 게터 메소드를 호출해서 필요한 값을 당겨오도록 변경한다.</p><p>푸시와 풀은 구현 방법의 문제이지만 시간이 지남에 따라 애플리케이션이 계속 바뀌고 복잡해지므로, 대체로 옵저버가 필요한 데이터를 골라서 가져가도록 만드는 방법이 더 좋다.</p><p><strong>주제에서 알림 보내기</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>Subject</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>notifyObservers</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=o>(</span><span class=n>Observer</span> <span class=n>observer</span><span class=o>:</span> <span class=n>observers</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>          <span class=n>observer</span><span class=o>.</span><span class=na>update</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>옵저버에서 알림 받기</strong></p><ol><li><code>Observer</code> 인터페이스에서 <code>update()</code> 메소드에 매개변수가 없도록 서명을 바꾼다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Observer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>update</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><code>update()</code> 메소드의 서명을 바꾸고 <code>Subject</code> 구상 주제 메소드의 게터로 날씨를 받아오도록 <code>Observer</code> 구상 클래스를 수정한다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>ExtendObserver</span> <span class=kd>extends</span> <span class=n>Observer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>update</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=o>.</span><span class=na>item</span> <span class=o>=</span> <span class=n>ExtendSubject</span><span class=o>.</span><span class=na>getItem</span><span class=o>();</span>
</span></span><span class=line><span class=cl>      <span class=err>이후</span><span class=n>_</span><span class=err>동작</span><span class=o>();</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=디자인-원칙>디자인 원칙</h3><ul><li>달라지는 부분을 찾아내고 달라지지 않는 부분과 분리한다.<ul><li>옵저버 패턴에서 변하는 것은 주제의 상태와 옵저버의 개수, 형식이다.</li><li>옵저버 패턴에서는 주제를 바꾸지 않고도 주제의 상태에 의존하는 객체들을 바꿀 수 있다.</li><li>나중에 바뀔 것을 대비해 두면 편하게 작업할 수 있다.</li></ul></li><li>구현보다는 인터페이스에 맞춰 프로그래밍한다.<ul><li>주제와 옵저버에서 모두 인터페이스를 사용했다.</li></ul></li><li>상속보다는 구성을 활용한다.<ul><li>옵저버 패턴에서는 구성을 활용해서 옵저버들을 관리한다.</li><li>주제와 옵저버 사이의 관계가 상속이 아닌 구성으로 이루어진다.</li></ul></li></ul><h2 id=기상-모니터링-애플리케이션>기상 모니터링 애플리케이션</h2><h3 id=요구-사항-분석>요구 사항 분석</h3><pre class=mermaid style=text-align:center>flowchart LR
    a((습도 센서))
    b((온도 센서))
    c((기압 센서))
    
    d([기상 스테이션])
    
    e((WeatherData 객체))
    
    f[[디스플레이 장비]]

    a-.->d
    b-.->d
    c-.->d
    
    d<-.데이터 취득.-e
    e-.화면에 표시.->f
</pre><ul><li>WatherData 객체를 바탕으로 만들어짐<ul><li>현재 기상 조건(온도, 습도 기압) 추적</li></ul></li><li>WatherData 객체를 바탕으로 3개 항목을 화면에 표시함<ul><li>현재 조건, 기상 통계, 간단한 기상 예보</li><li>해당 항목들이 최신 측정치를 수집할 때마다 실시간으로 갱신</li></ul></li><li>다른 개발자가 직접 날씨 디스플레이를 만덜어 바로 넣을 수 있도록 확장 가능해야 함</li><li>정보가 화면에 표시되는 횟수로 고객에가 요금 부과</li></ul><h3 id=구현-목표>구현 목표</h3><p>디스플레이를 구현하고 새로운 값이 들어올 때마다(<code>measurementsChanged()</code> 호출 시) <code>WeatherData</code>에서 디스플레이를 업데이트 해야한다.</p><pre class=mermaid style=text-align:center>classDiagram
    direction RL
    class WeatherData {
        getTemperature()
        getHumidity()
        getPressure()
        measurementsChanged()
    }
    
    note for WeatherData "기상 관측값 갱신시 measurementsChanged() 호출"
    
</pre><ul><li><code>WeatherData</code> 클래스에는 3가지 측정값(온도, 습도 기압)의 게터 메소드가 있다.</li><li>새로운 기상 측정 데이터가 들어올 때마다 <code>measurementsChanged()</code> 메소드가 호출됨<ul><li>이 메소드가 어떤 식으로 호출되는지 모른다(알 필요도 없다)</li></ul></li><li>가상 데이터를 사용하는 디스플레이 요소 3가지를 구현해야 한다.<ul><li>현재 조건, 기상 통계, 기상 예보</li></ul></li><li>디스플레이를 업데이트하도록 <code>measurementsChanged()</code>에 코드를 추가해야 한다.</li></ul><p><strong>추가 목표</strong></p><p>기상 스테이션이 성공하면 디스플레이가 더 늘어날 수도 있고, 디스플레이를 추가할 수 있는 마켓플레이스가 만들어질지도 모른다. 따라서 확장성을 고려한다면 좋을 수 있다.</p><h3 id=가상-스테이션용-코드-추가>가상 스테이션용 코드 추가</h3><p>1차적으로 다음과 같이 구현될 수 있다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>WeatherData</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 인스턴스 변수 선언
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>measurementsChanged</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 최신 측정값 가져오기
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>float</span> <span class=n>temp</span> <span class=o>=</span> <span class=n>getTemperature</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>float</span> <span class=n>humidity</span> <span class=o>=</span> <span class=n>getHumidity</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>float</span> <span class=n>pressure</span> <span class=o>=</span> <span class=n>getPressure</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 각 디스플레이 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>currentConditionsDisplay</span><span class=o>.</span><span class=na>update</span><span class=o>(</span><span class=n>temp</span><span class=o>,</span> <span class=n>humidity</span><span class=o>,</span> <span class=n>pressure</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>statisticsDisplay</span><span class=o>.</span><span class=na>update</span><span class=o>(</span><span class=n>temp</span><span class=o>,</span> <span class=n>humidity</span><span class=o>,</span> <span class=n>pressure</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>forecastDisplay</span><span class=o>.</span><span class=na>update</span><span class=o>(</span><span class=n>temp</span><span class=o>,</span> <span class=n>humidity</span><span class=o>,</span> <span class=n>pressure</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 기타 메소드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=원칙으로-추가-코드-살펴보기>원칙으로 추가 코드 살펴보기</h3><ul><li>구체적인 구현(Bad)<ul><li>각 디스플레이를 업데이트 하는 로직이 구체적인 구현에 맞춰져 있으므로 프로그램을 고치지 않고는 다른 디스플레이를 추가, 제거할 수 없다.</li></ul></li><li>캡슐화 부재(Bad)<ul><li>디스플에이를 업데이트 하는 로직은 바뀔 수 있는 부분으로 캡슐화가 필요함</li></ul></li><li>공통된 인터페이스(Good)<ul><li><code>{객체}.update</code> 메소드를 호출하는 것으로 업데이트를 하는 공통적인 인테페이스를 구성했음</li></ul></li></ul><h3 id=기상-스테이션-설계하기>기상 스테이션 설계하기</h3><pre class=mermaid style=text-align:center>classDiagram
    direction LR
    class Subject {
      << interface >>  
      registerObserver()
      removeObserver()
      notifyObservers()
    }
    class Observer {
      << interface >>  
      update()
    }
    class DisplayElement {
        << interface >>
        display()
    }
    
    class WeatherData {
        registerObserver()
        removeObserver()
        notifyObservers()
        
        getTemperature()
        getHumidity()
        getPressure()
        measurementsChanged()
    }
    
    class CurrentConditionsDisplay {
        update()
        display()
    }
    
    class StatisticsDisplay {
        update()
        display()
    }
    
    class ThirdPartyDisplay {
        update()
        display()
    }
    
    class ForecastDisplay {
        update()
        display()
    }

    Subject --> Observer : 옵저버
    WeatherData ..> Subject
    
    CurrentConditionsDisplay --> WeatherData : 주제
    CurrentConditionsDisplay ..> Observer
    
    StatisticsDisplay ..> DisplayElement
    StatisticsDisplay ..> Observer
    
    ThirdPartyDisplay ..> DisplayElement
    ThirdPartyDisplay ..> Observer
    
    ForecastDisplay ..> DisplayElement
    ForecastDisplay ..> Observer
</pre><ul><li>Subject: 주제 인터페이스</li><li>Observer: 옵저버 인터페이스, 주제에서 옵저버에게 갱신된 정보를 전달하는 방법 제공</li><li>DisplayElement: 모든 디스플레이 요소의 구현 인터페이스</li><li>WeatherData: Subject 인터페이스를 구현할 기상 정보</li><li>CurrentConditionsDisplay: WatherData 객체로부터 얻은 현재 측정값을 보여줄 옵저버 이면서 디스플레이 요소</li><li>StatisticsDisplay: 측정치의 통계치를 표시할 옵저버 이면서 디스플레이 요소</li><li>ForecastDisplay: 측정치를 바탕으로 기상 예보를 화면에 보여줄 디스플레이 요소</li><li>ThirdPartyDisplay: 새롭게 구현될 디스플레이 요소&mldr;</li></ul><h2 id=디자인-도구상자-안에-들어가야-할-도구들>디자인 도구상자 안에 들어가야 할 도구들</h2><ul><li>객체지향 기초<ul><li>추상화</li><li>캡슐화</li><li>다형성</li><li>상속</li></ul></li><li>객체지향 원칙<ul><li>바뀌는 부분은 캡슐화힌다.</li><li>상속보다는 구성을 활용한다.</li><li>구현보다는 인터페이스에 맞춰 프로그래밍한다.</li><li>+ 상호작용을 하는 객체 사이에는 가능하면 느슨한 결합을 사용한다.</li></ul></li><li>객체지향 패턴<ul><li>전략패턴</li><li>+ 옵저버 패턴<ul><li>한 객체의 상태가 바뀌면 그 객체에 의존하는 다른 객체에게 연락이 가고 자동으로 내용이 갱신되는 방식으로 일대다 의존성을 정의한다.</li></ul></li></ul></li></ul><h2 id=핵심-정리>핵심 정리</h2><ul><li>옵저버 패턴은 객체들 사이에 일대다 관계를 정의한다.</li><li>주제는 동일한 인터페이스를 써서 옵저버에게 연락한다.</li><li>Observer 인터페이스를 구현하기만 하면 어떤 구상 클래스의 옵저버라도 패턴에 참여할 수 있다.</li><li>주제는 옵저버들이 Observer 인터페이스를 구현한다는 것을 제외하면 옵저버에 관해 전혀 모른다.(느슨한 결합)</li><li>옵저버 패턴을 사용하면 주제가 데이터를 보내거나(푸시) 옵저버가 데이터를 가져올(풀) 수 있다.<ul><li>일반적으로 풀 방식을 옳은 방식으로 간주함</li></ul></li><li>옵저버 패턴은 여러 개의 주제와 메시지 유형이 있는 복잡한 상황에서 사용하는 출판-구독 패턴과 친척이다.</li><li>옵저버 패턴은 자주 쓰이는 패턴으로 모델-뷰-컨트롤러(MVC)를 배울 때 다시 볼 수 있을것이다.</li><li>GUI 프레임 워크들이 옵저버 패턴을 많이 사용한다.</li><li>RxJava, 자바빈, RMI 외 코코아, 스위프트, JS 같은 다른 언어의 프레임워크에서도 옵저버 패턴을 많이 사용한다.</li></ul></section><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
</script><footer class=article-footer><section class=article-tags><a href=/tags/common/>Common</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><div class="article-list--compact links"><article><a href=https://product.kyobobook.co.kr/detail/S000001810483 target=_blank rel=noopener><div class=article-details><h2 class=article-title>헤드 퍼스트 디자인 패턴</h2><footer class=article-time>교보 문고</footer></div></a></article></div><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/gof/10/><div class=article-image><img src=/post/gof/10/cover.5a69346fc08fc01c93d4735bb058551a_hu5fe9e632d31d6204170abf166c9a2927_244577_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 10. 객체의 상태 바꾸기 - 상태 패턴" data-key=gof/10 data-hash="md5-Wmk0b8CPwByT1HNbsFhVGg=="></div><div class=article-details><h2 class=article-title>10. 객체의 상태 바꾸기 - 상태 패턴</h2></div></a></article><article class=has-image><a href=/post/gof/9/><div class=article-image><img src=/post/gof/9/cover.5a69346fc08fc01c93d4735bb058551a_hu5fe9e632d31d6204170abf166c9a2927_244577_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 9. 컬렉션 잘 관리하기 - 반복자 패턴과 컴포지트 패턴" data-key=gof/9 data-hash="md5-Wmk0b8CPwByT1HNbsFhVGg=="></div><div class=article-details><h2 class=article-title>9. 컬렉션 잘 관리하기 - 반복자 패턴과 컴포지트 패턴</h2></div></a></article><article class=has-image><a href=/post/gof/8/><div class=article-image><img src=/post/gof/8/cover.5a69346fc08fc01c93d4735bb058551a_hu5fe9e632d31d6204170abf166c9a2927_244577_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 8. 알고리즘 캡슐화하기 - 탬플릿 메소드 패턴" data-key=gof/8 data-hash="md5-Wmk0b8CPwByT1HNbsFhVGg=="></div><div class=article-details><h2 class=article-title>8. 알고리즘 캡슐화하기 - 탬플릿 메소드 패턴</h2></div></a></article><article class=has-image><a href=/post/gof/7/><div class=article-image><img src=/post/gof/7/cover.5a69346fc08fc01c93d4735bb058551a_hu5fe9e632d31d6204170abf166c9a2927_244577_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 7. 어댑터 패턴과 퍼사드 패턴" data-key=gof/7 data-hash="md5-Wmk0b8CPwByT1HNbsFhVGg=="></div><div class=article-details><h2 class=article-title>7. 어댑터 패턴과 퍼사드 패턴</h2></div></a></article><article class=has-image><a href=/post/gof/6/><div class=article-image><img src=/post/gof/6/cover.5a69346fc08fc01c93d4735bb058551a_hu5fe9e632d31d6204170abf166c9a2927_244577_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 6. 커맨드 패턴 - 호출 캡슐화하기" data-key=gof/6 data-hash="md5-Wmk0b8CPwByT1HNbsFhVGg=="></div><div class=article-details><h2 class=article-title>6. 커맨드 패턴 - 호출 캡슐화하기</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=codemario318/codemario318.github.io issue-term=pathname label=Comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2024 Mario Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>