<!doctype html><html lang=ko dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="가상 면접 사례로 배우는 대규모 시스템 설계 기초"><title>12. 채팅 시스템 설계</title><link rel=canonical href=https://codemario318.github.io/post/system-design-interview/12/><link rel=stylesheet href=/scss/style.min.cbce94e2760d14d60414e59d5a36ab2819232375817e010dbe7be2234b67da1b.css><meta property="og:title" content="12. 채팅 시스템 설계"><meta property="og:description" content="가상 면접 사례로 배우는 대규모 시스템 설계 기초"><meta property="og:url" content="https://codemario318.github.io/post/system-design-interview/12/"><meta property="og:site_name" content="Mario Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="가상 면접 사례로 배우는 대규모 시스템 설계 기초"><meta property="article:tag" content="System Design Interview"><meta property="article:tag" content="채팅 시스템"><meta property="article:tag" content="Chat System"><meta property="article:tag" content="폴링"><meta property="article:tag" content="Polling"><meta property="article:tag" content="롱 폴링"><meta property="article:tag" content="Long pooling"><meta property="article:tag" content="상태 유지 서비스"><meta property="article:tag" content="Stateful Service"><meta property="article:tag" content="실시간 서비스"><meta property="article:tag" content="Real-time Service"><meta property="article:tag" content="웹소켓"><meta property="article:tag" content="WebSocket"><meta property="article:tag" content="메시지큐"><meta property="article:tag" content="Message Queue"><meta property="article:tag" content="키-값 저장소"><meta property="article:tag" content="Key-value Store"><meta property="article:tag" content="발행-구독 모델"><meta property="article:tag" content="Publish-subscribe Model"><meta property="article:published_time" content="2024-07-05T10:02:50+09:00"><meta property="article:modified_time" content="2024-07-05T10:02:50+09:00"><meta property="og:image" content="https://codemario318.github.io/post/system-design-interview/12/cover.png"><meta name=twitter:title content="12. 채팅 시스템 설계"><meta name=twitter:description content="가상 면접 사례로 배우는 대규모 시스템 설계 기초"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codemario318.github.io/post/system-design-interview/12/cover.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-K99591YLGK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K99591YLGK",{anonymize_ip:!1})}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3183752545292673" crossorigin=anonymous></script><meta name=naver-site-verification content="2315bde85c86f66092140cc465c340a2170f3187"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu760fd15c5fbb2f30cf0868dc4a5dc41a_14271_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Mario Blog</a></h1><h2 class=site-description></h2></div></header><ol class=social-menu><li><a href=https://github.com/codemario318 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><ul class="menu sub-menu"><li><a href=/categories/backend/><span>Backend</span>
<span class=content-count>3</span></a></li><li><a href=/categories/boostcamp/><span>부스트캠프</span>
<span class=content-count>11</span></a></li><li><a href=/categories/cleancode/><span>Clean Code</span>
<span class=content-count>10</span></a></li><li><a href=/categories/common/><span>Common</span>
<span class=content-count>76</span></a></li><li><a href=/categories/data/><span>Data</span>
<span class=content-count>3</span></a></li><li><a href=/categories/db/><span>DB</span>
<span class=content-count>2</span></a></li><li><a href=/categories/frontend/><span>Frontend</span>
<span class=content-count>10</span></a></li><li><a href=/categories/golang/><span>GoLang</span>
<span class=content-count>13</span></a></li><li><a href=/categories/headfirstdesignpatterns/><span>헤드 퍼스트 디자인 패턴</span>
<span class=content-count>22</span></a></li><li><a href=/categories/infra/><span>Infra</span>
<span class=content-count>14</span></a></li><li><a href=/categories/nest/><span>Nest</span>
<span class=content-count>1</span></a></li><li><a href=/categories/network/><span>네트워크</span>
<span class=content-count>1</span></a></li><li><a href=/categories/node/><span>Node</span>
<span class=content-count>6</span></a></li><li><a href=/categories/others/><span>Others</span>
<span class=content-count>4</span></a></li><li><a href=/categories/problemsolving/><span>Problem Solving</span>
<span class=content-count>1</span></a></li><li><a href=/categories/project/><span>Project</span>
<span class=content-count>5</span></a></li><li><a href=/categories/realmysql/><span>Real MySQL</span>
<span class=content-count>53</span></a></li></ul><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1단계-문제-이해-및-설계-범위-확정>1단계: 문제 이해 및 설계 범위 확정</a></li><li><a href=#2단계-개략적-설계안-제시-및-동의-구하기>2단계: 개략적 설계안 제시 및 동의 구하기</a><ol><li><a href=#폴링>폴링</a></li><li><a href=#롱-폴링>롱 폴링</a></li><li><a href=#웹소켓>웹소켓</a></li><li><a href=#개략적-설계안>개략적 설계안</a><ol><li><a href=#무상태-서비스>무상태 서비스</a></li><li><a href=#상태-유지-서비스>상태 유지 서비스</a></li><li><a href=#써드파티-서비스-연동>써드파티 서비스 연동</a></li><li><a href=#규모-확장성>규모 확장성</a></li><li><a href=#저장소>저장소</a></li></ol></li><li><a href=#데이터-모델>데이터 모델</a><ol><li><a href=#11-채팅을-위한-메시지-테이블>1:1 채팅을 위한 메시지 테이블</a></li><li><a href=#그룹-채팅을-위한-메시지-테이블>그룹 채팅을 위한 메시지 테이블</a></li><li><a href=#메시지-id>메시지 ID</a></li></ol></li></ol></li><li><a href=#3단계-상세-설계>3단계: 상세 설계</a><ol><li><a href=#서비스-탐색>서비스 탐색</a></li><li><a href=#메시지-흐름>메시지 흐름</a><ol><li><a href=#11-채팅-메시지-처리-흐름>1:1 채팅 메시지 처리 흐름</a></li><li><a href=#여러-단말-사이의-메시지-동기화>여러 단말 사이의 메시지 동기화</a></li><li><a href=#소규모-그룹-채팅에서의-메시지-흐름>소규모 그룹 채팅에서의 메시지 흐름</a></li></ol></li><li><a href=#접속-상태-표시>접속 상태 표시</a></li><li><a href=#상태-정보의-전송>상태 정보의 전송</a></li></ol></li><li><a href=#4단계-마무리>4단계: 마무리</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/system-design-interview/12/><img src=/post/system-design-interview/12/cover_huebcf5dd667df9af228f80687035dfdfb_164704_800x0_resize_box_3.png srcset="/post/system-design-interview/12/cover_huebcf5dd667df9af228f80687035dfdfb_164704_800x0_resize_box_3.png 800w, /post/system-design-interview/12/cover_huebcf5dd667df9af228f80687035dfdfb_164704_1600x0_resize_box_3.png 1600w" width=800 height=454 loading=lazy alt="Featured image of post 12. 채팅 시스템 설계"></a></div><div class=article-details><header class=article-category><a href=/categories/common/ style=background-color:#2a9d8f;color:#fff>Common</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/system-design-interview/12/>12. 채팅 시스템 설계</a></h2><h3 class=article-subtitle>가상 면접 사례로 배우는 대규모 시스템 설계 기초</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2024/07/05</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>12 minute read</time></div></footer></div></header><section class=article-content><p>이번 장에서는 채팅 시스템을 설계해본다.</p><p>채팅 앱은 중점적으로 다뤄야하는 문제에 따라 방향성이 달라질 수 있으므로, 요구사항을 확실히 파악하는것이 매우 중요하기 때문에, 어떤 채팅 앱을 설계하려는지 확실히 해 두는것이 중요하다.</p><ul><li>1:1 채팅 중점<ul><li>페이스북 메신저, 위챗, 왓츠앱 등</li></ul></li><li>그룹 채팅 중점<ul><li>슬랙 등</li></ul></li><li>대규모 그룹의 소통과 음성 채팅<ul><li>디스코드 등</li></ul></li></ul><h2 id=1단계-문제-이해-및-설계-범위-확정>1단계: 문제 이해 및 설계 범위 확정</h2><p>질문을 통해 의도를 파악한다.</p><ul><li>Q. 1:1 채팅, 그룹 채팅?<ul><li>A. 둘 다.</li></ul></li><li>Q. 모바일? 웹?<ul><li>A. 둘 다.</li></ul></li><li>Q. 트래픽 규모는?<ul><li>A. DAU 5천만</li></ul></li><li>Q. 그룹 채팅의 인원 제한?<ul><li>A. 최대 100명</li></ul></li><li>Q. 중요 기능으로는?<ul><li>A. 1:1 채팅, 그룹 채팅, 사용자 접속 상태 표시, 텍스트 메시지만 허용</li></ul></li><li>Q. 메시지 길이 제한은?<ul><li>A. 100,000자 이하</li></ul></li><li>Q. 종단 간 암호화(end-to-end encryption) 지원?<ul><li>A. 현재로서는 불필요</li></ul></li><li>Q. 채팅 이력은 얼마나 보관?<ul><li>A. 영원히.</li></ul></li></ul><p>위와 같은 질의응답을 통해 아래와 같은 요구사항을 찾을 수 있다.</p><ul><li>응답지연이 낮은 일대일 채팅기능(DAU)</li><li>최대 100명까지 참여할 수 있는 그룹 채팅 기능</li><li>사용자의 접속상태 표시 기능</li><li>다양한 단말 지원, 하나의 계정으로 여러 단말에 동시 접속 지원(웹, 앱 둘다 고려)</li><li>푸시 알림</li></ul><h2 id=2단계-개략적-설계안-제시-및-동의-구하기>2단계: 개략적 설계안 제시 및 동의 구하기</h2><p>채팅 시스템의 경우 클라이언트는 모바일 앱이거나 웹 애필리케이션이다.</p><p>클라이언트는 서로 직접 통신하지 않는 대신, 각 클라이언트는 위에 나열한 모든 기능을 지우너하는 채팅 서비스와 통신한다.</p><p>따라서 채팅 서비스는 아래 기능을 제공해야 한다.</p><ul><li>클라이언트들로부터 메시지 수진</li><li>메시지 수신자(recipient) 결정 및 전달</li><li>수신자가 접속 상태가 아닌 경우 접속할 때까지 해당 메시지 보관</li></ul><p><img src=/post/system-design-interview/12/img.png width=831 height=141 srcset="/post/system-design-interview/12/img_hu846a4193e09f6599f67011f5f29692cb_42945_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_hu846a4193e09f6599f67011f5f29692cb_42945_1024x0_resize_box_3.png 1024w" loading=lazy alt="클라이언트와 채팅 서비스 관계" class=gallery-image data-flex-grow=589 data-flex-basis=1414px></p><p>채팅을 시작하려는 클라이언트는 네트워크 통신 프로토콜을 사용하여 서비스에 접속하므로, 어떤 통신 프로토콜을 사용할 것인가도 중요한 문제다.</p><p>대부분의 클라이언트/서버 애플리케이션에서 요청을 보내는 것은 클라이언트이며, 채팅 시스템도 마찬가지다.</p><p>위 예시에서는 송신 클라이언트가 수신 클라이언트에게 전달 할 메시지를 보낼 때, 오랜 세월 검증된 <strong>HTTP 프로토콜</strong>을 사용한다.</p><p>HTTP를 사용한다면, 채팅 서비스에서는 클라이언트가 지속적으로 메시지를 보낸다는 특성을 고려하여, <code>keep-alive</code> 헤더를 사용해 서버와 클라이언트가 연결을 끊지 않고 유지하는 것이 좋다.</p><p>하지만 메시지 발신에 비해 수신 시나리오는 이것보다 복잡하기 때문에 HTTP가 적절치 않을 수 있다.</p><ul><li>서버가 채팅 발신 요청을 받게 되면, 서버가 수신자에게 메시지를 전달해야한다.</li><li>HTTP는 클라이언트가 연결을 만드는 특성으로, 서버에서 클라이언트로 임의 시점에 메시지를 보내는 데 쉽게 쓰일 수 없다.</li></ul><p>이러한 문제를 개선하기위해 서버가 연결을 만드는 것처럼 동작하는 많은 기법이 제안되었다.</p><ul><li>폴링, 롱폴링, 웹소켓</li></ul><h3 id=폴링>폴링</h3><p>폴링은 클라이언트가 주기적으로 서버에게 새 메시지가 있는냐고 물어보는 방법이다.</p><p><img src=/post/system-design-interview/12/img_1.png width=831 height=879 srcset="/post/system-design-interview/12/img_1_huaa79ccbd5858bc013d0c473ceded0490_112044_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_1_huaa79ccbd5858bc013d0c473ceded0490_112044_1024x0_resize_box_3.png 1024w" loading=lazy alt=폴링 class=gallery-image data-flex-grow=94 data-flex-basis=226px></p><p>폴링 비용은 폴링을 자주하면 할수록 올라가므로, 답해줄 메시지가 없는 경우에는 서버 자원이 불필요하게 낭비된다.</p><h3 id=롱-폴링>롱 폴링</h3><p>폴링의 비효율성을 개선하기위해 롱 폴링이 제안되었다.</p><p><img src=/post/system-design-interview/12/img_2.png width=831 height=746 srcset="/post/system-design-interview/12/img_2_hu9446a286a0026c1d57706962c9f7b24e_79065_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_2_hu9446a286a0026c1d57706962c9f7b24e_79065_1024x0_resize_box_3.png 1024w" loading=lazy alt="롱 폴링" class=gallery-image data-flex-grow=111 data-flex-basis=267px></p><ul><li>클라이언트는 새 메시지가 반환되거나 타임아웃 될 때가지 연결을 유지한다.</li><li>새 메시지를 받으면 기존 연결을 종료하고 서버에 새로운 요청을 보내 모든 절차를 다시 시작한다.</li></ul><p>이 방법은 다음과 같은 약점이 있다.</p><ul><li>메시지를 보내는 클라이언트가 수신하는 클라이언트가 같은 채팅 서버에 접속하지 않을 수 있다.<ul><li>HTTP 서버들은 보통 무상태이다. 즉 로드 밸런싱을 위해 라운드 로빈 알고리즘을 사용하는 경우(요청을 무작위로 분산하는 경우), 메시지를 받은 서버는 해당 메시지를 수신할 클라이언트와의 롱 폴링 연결을 가지고 있지 않은 서버일 수 있다.</li></ul></li><li>서버는 클라이언트가 연결을 해제했는지 알 수 있는 좋은 방법이 없다.</li><li>여전히 비효율적이다.<ul><li>메시지를 많이 받지 않는 클라이언트도 타임아웃이 일어날 때마다 주기적으로 서버에 다시 접속한다.</li></ul></li></ul><h3 id=웹소켓>웹소켓</h3><p>웹소켓은 서버가 클라이언트에게 비동기 메시지를 보낼 때 가장 널리 사용하는 기술이다.</p><p><img src=/post/system-design-interview/12/img_3.png width=821 height=498 srcset="/post/system-design-interview/12/img_3_huebfcb5cdfaf26f40aef3085b89b61c7b_77060_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_3_huebfcb5cdfaf26f40aef3085b89b61c7b_77060_1024x0_resize_box_3.png 1024w" loading=lazy alt=웹소켓 class=gallery-image data-flex-grow=164 data-flex-basis=395px></p><ul><li>웹소켓 연결은 클라이언트가 시작하며, 한번 맺어진 연결은 항구적이며(변하지않고 오래가며) 양방향이다.</li><li>처음에는 HTTP 연결이지만 특정 핸드셰이크 절차를 거져 웹소켓 연결로 업그레이드된다.<ul><li>일반적으로 방화벽이 있는 환경에서도 잘 동작한다.</li><li>HTTP, HTTPS 가 쓰는 포트를 그대로 활용한다.</li></ul></li><li>연결이 만들어지고 나면, 서버는 클라이언트에게 비동기적으로 메시지를 전송할 수 있다.</li></ul><p>웹소켓은 메시지를 보내려는 클라이언트에게 준수한 HTTP 프로토콜의 특징에 더해 양방향 메시지 전송까지 가능하게 한다.</p><p><img src=/post/system-design-interview/12/img_4.png width=607 height=355 srcset="/post/system-design-interview/12/img_4_huc6205357ded82087fb2f30ab5b292d46_55256_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_4_huc6205357ded82087fb2f30ab5b292d46_55256_1024x0_resize_box_3.png 1024w" loading=lazy alt="웹소켓 활용 예시" class=gallery-image data-flex-grow=170 data-flex-basis=410px></p><ul><li>웹소켓을 이용하면 메시지를 보낼 때나 받을 때 동일한 프로토콜을 사용할 수 있으므로, 설계와 구현이 단순하고 직관적이다.</li><li>단, 웹소켓 연결은 항구적으로 유지되어야 하기 때문에 서버 측에서 연결 관리를 효율적으로 해야한다.</li></ul><h3 id=개략적-설계안>개략적 설계안</h3><p>클라이언트와 서버 사이의 주 통신 프로토콜로 웹소켓을 사용하지만, 다른 부분에서는 굳이 웹소켓을 쓸 필요는 없다.</p><p>대부분의 기능인 회원가입, 로그인, 사용자 프로파일 등은 기존 HTTP상에서 구현하는 것이 더 좋다.</p><p><img src=/post/system-design-interview/12/img_5.png width=644 height=853 srcset="/post/system-design-interview/12/img_5_hu3b37951fbb1bf15ccce6fcd26ff957e5_234991_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_5_hu3b37951fbb1bf15ccce6fcd26ff957e5_234991_1024x0_resize_box_3.png 1024w" loading=lazy alt="개략적 설계안" class=gallery-image data-flex-grow=75 data-flex-basis=181px></p><p>채팅 시스템은 세 부분으로 나눠볼 수 있다.</p><h4 id=무상태-서비스>무상태 서비스</h4><p>이 설계안에서 무상태 서비스는 로그인, 회원가입, 사용자 프로파일 표시 등을 처리하는 <strong>전통적인 요청/응답</strong> 서비스다.</p><ul><li>일반적인 웹과 앱이 제공하는 기능들</li></ul><p>무상태 서비스는 로드밸런서 뒤에 위치한다.</p><ul><li><strong>서비스 탐색(sevice discovery) 서비스</strong><ul><li>클라이언트가 접속할 채팅 서버의 DNS 호스트명을 클라이언트에게 알려주는 역할을 한다.</li></ul></li></ul><h4 id=상태-유지-서비스>상태 유지 서비스</h4><p>채팅 서비스는 각 클라이언트는 채팅 서버와 독립적인 네트워크를 유지해야한다.</p><ul><li>클라이언트는 보통 다른 서버로 연결을 변경하지 않는다.</li><li>서비스 탐색 서비스가 채팅 서버스와 긴밀히 협력하여 특정 서버에 부하가 몰리지 않도록 한다.</li></ul><h4 id=써드파티-서비스-연동>써드파티 서비스 연동</h4><p>채팅 앱에서 가장 중요한 써드파티 서비스는 푸시 알림이다.</p><ul><li>새 메시지 수신시 앱이 실행중이지 않더라도 알림을 받아야한다.</li></ul><p>따라서 푸시 알림 서비스와의 통합은 아주 중요하다.</p><h4 id=규모-확장성>규모 확장성</h4><p>이번 장에서 다루는 시스템은 동시 접속자가 1M 이라고 가정하는데, 접속당 10K 서버 메모리가 필요하다면, 10GB 메모리만으로도 처리 가능하다.</p><p>하지만 이정도 규모의 트래픽을 서버 한대로 처리하는 것은 <strong>SPOF</strong> 등의 이유로 적절치 않다.</p><p><img src=/post/system-design-interview/12/img_6.png width=797 height=872 srcset="/post/system-design-interview/12/img_6_hu2f66c0a05c004fc0f4d257e106c12a84_230686_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_6_hu2f66c0a05c004fc0f4d257e106c12a84_230686_1024x0_resize_box_3.png 1024w" loading=lazy alt="개략적 설계안 최종" class=gallery-image data-flex-grow=91 data-flex-basis=219px></p><p>유의할 것은 실시간으로 메시지를 주고받기 위해 클라이언트는 채팅 서버와 웹소켓 연결을 끊지 않고 유지한다는 것이다.</p><ul><li>채팅 서버<ul><li>클라이언트 사이에 메시지를 중계하는 역할 담당</li></ul></li><li>접속 상태 서버(Presence server)<ul><li>사용자의 접속 여부 관리</li></ul></li><li>API 서버<ul><li>로그인, 회원가입, 프로파일 변경 등 그 외 나머지를 전부 처리(무상태)</li></ul></li><li>알림 서버<ul><li>푸시 알림을 보냄</li></ul></li><li>키-값 저장소<ul><li>채팅 이력을 보관</li><li>시스템에 접속한 사용자는 이전 채팅 이력을 전부 보게된다.</li></ul></li></ul><h4 id=저장소>저장소</h4><p>채팅 시스템의 기술 스택중 가장 중요한 부분 중 하나는 데이터 계층으로, 이 계층을 올바르게 만드는 데는 노력이 필요하다.</p><p>중요한 선택 중 하나는 어떤 데이터베이스를 쓰는가(관계형, NoSQL 등)이며, 고려해야 할 핵심 요인은 <strong>데이터의 유형</strong>과 <strong>읽기/쓰기 연산의 패턴</strong> 이다.</p><p>채팅 시스템에서는 보통 두 가지다.</p><p><strong>사용자 프로파일, 설정, 친구 목록과 같은 일반적인 데이터</strong><br>안정성을 보장하는 관계형 데이터베이스가 적절하다.</p><ul><li>다중화(replication)와 샤딩(sharding)으로 이러한 데이터의 가용성과 규모확장성을 보증할 수 있다.</li></ul><p><strong>채팅 시스템에 고유한 데이터(채팅 이력)</strong><br>이러한 유형의 데이터를 어떻게 보관할 지 결정하려면 읽기/쓰기 연산 패턴을 이해해야한다.</p><ul><li>채팅 이력 데이터 양은 엄청나다.<ul><li>페이스북 메신저나 왓츠앱은 매일 600억개 메시지를 처리함</li></ul></li><li>빈번하게 사용되는 것은 주로 최근에 주고받은 메시지이다.<ul><li>대부분 사용자는 오래된 메시지는 확인하지 않는다.</li></ul></li><li>검색 기능, 언급(mention)된 메시지, 특정 메시지로 점프 하는 등 무작위적인 데이터 접근을 하는 경우도 있다.</li><li>1:1 채팅 앱의 경우 읽기:쓰기 비율은 대략 1:1</li></ul><p><strong>키-값 저장소</strong>가 이러한 패턴을 지원할 수 있는 데이터베이스이다.</p><ul><li>수평적 규모 확장이 쉽다.</li><li>데이터 접근 지연시간이 낮다.</li><li>관계형 데이터베이스는 롱 테일에 해당하는(넓고 적게 분포하는) 데이터를 잘 처리하지 못하는 경향이 있다.<ul><li>인덱스가 커지면 무작위 접근을 처리하는 비용이 늘어난다.</li></ul></li><li>이미 많은 안정적인 채팅 시스템이 키-값 저장소를 채택하고있다.<ul><li>페이스북: Hbase, 디스코드: 카산드라 등</li></ul></li></ul><blockquote><p>롱테일 효과란?<br><img src=/post/system-design-interview/12/img_7.png width=487 height=360 srcset="/post/system-design-interview/12/img_7_hub3d79bb345ad1bef179816c28fd060f6_45686_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_7_hub3d79bb345ad1bef179816c28fd060f6_45686_1024x0_resize_box_3.png 1024w" loading=lazy alt="롱테일 효과" class=gallery-image data-flex-grow=135 data-flex-basis=324px><br>파레토 법칙에 의한 80:20 집중 현상을 그래프에 나타냈을 때 꼬리처림 긴 부분을 형성하는 80%의 부분</p></blockquote><h3 id=데이터-모델>데이터 모델</h3><h4 id=11-채팅을-위한-메시지-테이블>1:1 채팅을 위한 메시지 테이블</h4><pre class=mermaid style=text-align:center>erDiagram
    Message {
        message_id bigint
        message_from bigint
        message_to bigint
        content text
        created_at timestamp
    }
</pre><p><code>Message</code> 테이블의 기본키는 <code>message_id</code>로, 메시지 순서를 쉽게 정할 수 있도록 하는 역할도 담당한다.</p><ul><li><code>created_at</code>은 메시지가 동시에 만들어 질 수 있으므로 순서를 정할 수 없다.</li></ul><h4 id=그룹-채팅을-위한-메시지-테이블>그룹 채팅을 위한 메시지 테이블</h4><pre class=mermaid style=text-align:center>erDiagram
    GroupMessage {
        channel_id bigint
        message_id bigint
        message_to bigint
        content text
        created_at timestamp
    }
</pre><p><code>(channel_id, message_id)</code> 복합키를 기본 키로 사용한다.</p><ul><li>채널은 채팅 그룹과 같은 뜻</li><li>그룹 채팅에 적용될 모든 질의는 특정 채널을 대상으로 하기 때문에 <code>channel_id</code>는 파티션 키로 사용할 수 있다.</li></ul><h4 id=메시지-id>메시지 ID</h4><p>위에서 언급한 것 처럼 메시지 ID는 메시지들의 순서도 표현할 수 있어야한다.</p><ul><li><code>messege_id</code>는 고유해야한다.</li><li>ID는 정렬 가능해하하며, 시간 순서와 일치해야한다.<ul><li>새로운 ID는 이전 ID 보다 큰 값이어야 한다.</li></ul></li></ul><p>RDMBS라면 <code>auto_increment</code>가 대안이 될 수 있지만 NoSQL은 보통 해당 기능을 제공하지 않는다.</p><ul><li>스노 플레이크 같은 전역적 순서 번호 생성기를 이용한다.</li><li>지역적 순서 번호 생성기를 이용한다.</li></ul><p><strong>지역적 순서 번호 생성기(Local sequence number generator)</strong>
유일성은 같은 그룹 안에서만 보증하면 충분하다는 의미이다.</p><ul><li>채팅 서비스의 특징에 따라 메시지의 순서는 같은 채널, 혹은 1:1 채팅 세션 안에서만 유지되면 충분하다.</li><li>전역적 ID 생성기에 비해 구현이 쉽다.</li></ul><h2 id=3단계-상세-설계>3단계: 상세 설계</h2><p>채팅 시스템의 <strong>서비스 탐색</strong>(service discovery), 메시지 전달 흐름, 사용자 접속 상태 표시하는 법 정도가 세부적으로 살펴보기 적절하다.</p><h3 id=서비스-탐색>서비스 탐색</h3><p>서비스 탐색 기능의 주된 역할은 <strong>클라이언트에게 가장 적합한 채팅 서버를 추천</strong>하는 것으로 아래의 기준을 활용하여 추천하게된다.</p><ul><li>클라이언트의 위치(Geographical location)</li><li>서버의 용량 등</li></ul><p>서비스 탐색 기능을 구현하는 데 널리 쓰이는 오픈 소스 솔루션으로 <strong>아파치 주키퍼</strong>같은 것이 있다.</p><ul><li>사용 가능한 모든 채팅 서버를 등록시켜 두고, 클라이언트가 접속을 시도하면 사전에 정한 기준에 따라 최적의 채팅 서버를 골라준다.</li></ul><p><img src=/post/system-design-interview/12/img_8.png width=718 height=698 srcset="/post/system-design-interview/12/img_8_hu68029a52e7e091c75ea09add17c7232a_109024_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_8_hu68029a52e7e091c75ea09add17c7232a_109024_1024x0_resize_box_3.png 1024w" loading=lazy alt="주키퍼로 구현한 서비스 탐색 흐름" class=gallery-image data-flex-grow=102 data-flex-basis=246px></p><ol><li>사용자 A가 시스템에 로그인 시도</li><li>로드밸런서가 로그인 요청을 API 서버들 가운데 하나로 보냄</li><li>API 서버가 사용자 인증을 처리하고 나면 서비스 탐색 기능이 동작하여 최적의 채팅 서버를 찾음</li><li>찾은 서버와 웹소켓 연결</li></ol><h3 id=메시지-흐름>메시지 흐름</h3><p>채팅 시스템에 있어서 종단 간 메시지 흐름을 이해하는 것은 흥미로운 주제이다.</p><p>1:1 채팅 메시지의 처리 흐름과 여러 단말 간 메시지 동기화 과정을 살펴본 후, 그룹 채팅 메시지의 처리 흐름을 살펴본다.</p><h4 id=11-채팅-메시지-처리-흐름>1:1 채팅 메시지 처리 흐름</h4><p><img src=/post/system-design-interview/12/img_9.png width=675 height=721 srcset="/post/system-design-interview/12/img_9_hu69fa1b06e4a527bf42d264a7bc16f467_126368_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_9_hu69fa1b06e4a527bf42d264a7bc16f467_126368_1024x0_resize_box_3.png 1024w" loading=lazy alt="1:1 채팅 메시지 처리 흐름" class=gallery-image data-flex-grow=93 data-flex-basis=224px></p><ol><li>사용자 A가 채팅 서버 1로 메시지 전송</li><li>채팅 서버 1은 ID 생성기를 사용해 해당 메시지의 ID 결정</li><li>채팅 서버 1은 해당 메시지를 메시지 동기화 큐로 전송</li><li>메시지가 키-값 저장소에 보관됨</li><li><ol><li>사용자 B가 접속 중인 경우 메시지는 접속 중인 채팅 서버로 전송</li><li>사용자가 B가 접속 중이 아닌 경우 푸시 알림 메시지를 푸시 알림 서버로 보냄</li></ol></li><li>채팅 서버는 웹소켓 연결을 통해 메시지를 사용자 B에게 전송.</li></ol><h4 id=여러-단말-사이의-메시지-동기화>여러 단말 사이의 메시지 동기화</h4><p><img src=/post/system-design-interview/12/img_10.png width=827 height=601 srcset="/post/system-design-interview/12/img_10_hu237dc5988b99c0258bbc96b3a092c068_95136_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_10_hu237dc5988b99c0258bbc96b3a092c068_95136_1024x0_resize_box_3.png 1024w" loading=lazy alt="메시지 동기화" class=gallery-image data-flex-grow=137 data-flex-basis=330px></p><p>각 단말은 관측된 가장 최신 메시지의 ID를 추적하기 위한 <code>cur_max_message_id</code> 라는 변수를 유지한다.</p><ul><li>수신자 ID가 현재 로그인한 사용자 ID와 같다.</li><li>키-값 저장소에 보관된 메시지로서, 그 ID가 <code>cur_max_message_id</code>보다 크다.</li></ul><p>위 조건을 만족하는 메시지는 새 메시지로 간주된다.</p><p><code>cur_max_message_id</code>는 단말마다 별도로 유지 관리하면 되는 값이라 키-값 저장소에서 새 메시지를 가져오는 동기화 작업도 쉽게 구현할 수 있다.</p><h4 id=소규모-그룹-채팅에서의-메시지-흐름>소규모 그룹 채팅에서의 메시지 흐름</h4><p><img src=/post/system-design-interview/12/img_11.png width=747 height=649 srcset="/post/system-design-interview/12/img_11_hu3912c41ccdd5c95c734f65d055df6d26_117861_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_11_hu3912c41ccdd5c95c734f65d055df6d26_117861_1024x0_resize_box_3.png 1024w" loading=lazy alt="소규모 그룹 채팅 메시지 흐름" class=gallery-image data-flex-grow=115 data-flex-basis=276px></p><p>1:1 채팅에 비해 조금 더 복잡하다.</p><p>사용자 A가 그룹 채팅방에서 메시지를 보내면, 사용자 B, C의 <strong>메시지 동기화 큐</strong>에 복사된다.</p><p>이러한 설계는 소규모 그룹 채팅에 적합하다.</p><ul><li>새로운 메시지가 왔는지 확인하려면 자기 큐만 보면 되므로 메시지 동기화 플로가 단순하다.</li><li>그룹이 크지 않으면 메시지를 수신자별로 복사해서 큐에 넣는 작업 비용이 문제되지 않는다.</li></ul><p>많은 사용자를 지원해야 하는 경우라면 똑같은 메시지를 모든 사용자의 큐에 복사하는 게 바람직하지 않다.</p><p><img src=/post/system-design-interview/12/img_12.png width=716 height=620 srcset="/post/system-design-interview/12/img_12_hub1a8d58b86737e6dabf10d70f993bb1d_101204_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_12_hub1a8d58b86737e6dabf10d70f993bb1d_101204_1024x0_resize_box_3.png 1024w" loading=lazy alt="수신자 관점 메시지 흐름" class=gallery-image data-flex-grow=115 data-flex-basis=277px></p><p>위와 같은 흐름을 <strong>메시지 수신자</strong> 관점에서 살펴보면, 한 수신자는 여러 사용자로부터 오는 메시지를 수신할 수 있어야 한다.</p><h3 id=접속-상태-표시>접속 상태 표시</h3><p>사용자 접속 상태를 표시하는 것은 상당수 채팅 애플리케이션의 핵심 기능이다.</p><p>개략적 설계안의 <strong>접속 상태 서버</strong>(presense server)를 통해 사용자의 상태를 관리하는데, 접속상태 서버는 클라이언트와 웹소켓으로 통신하는 실시간 서비스의 일부라는 점에 유의해야한다.</p><p><strong>사용자 로그인</strong></p><p><img src=/post/system-design-interview/12/img_13.png width=766 height=206 srcset="/post/system-design-interview/12/img_13_hub37db33c8b8c4205291185c196c0ce06_57084_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_13_hub37db33c8b8c4205291185c196c0ce06_57084_1024x0_resize_box_3.png 1024w" loading=lazy alt=로그인 class=gallery-image data-flex-grow=371 data-flex-basis=892px></p><p>클라이언트와 실시간 서비스 사이에 웹소켓 연결이 맺어지고 나면 접속상태 서버는 A의 상태와 <code>last_active_at</code> 타임스탬프 값을 키-값 저장소에 보관한다.</p><p>이 절차가 끝나면 해당 사용자는 접속 중인 것으로 표시될 것이다.</p><p><strong>로그아웃</strong></p><p><img src=/post/system-design-interview/12/img_14.png width=830 height=167 srcset="/post/system-design-interview/12/img_14_huc82ec414ab58d2aa81718a978ef2720f_65884_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_14_huc82ec414ab58d2aa81718a978ef2720f_65884_1024x0_resize_box_3.png 1024w" loading=lazy alt=로그아웃 class=gallery-image data-flex-grow=497 data-flex-basis=1192px></p><p>키-값 저장소에 보관된 사용자 상태가 <code>online</code>에서 <code>offline</code>으로 바뀐다.</p><p><strong>접속 장애</strong></p><p>인터넷 연결이 끊어지는 상황에 대응할 수 있는 설계를 준비해야한다.</p><p>사용자의 인터넷 연결이 끊어지면 클라이언트와 서버 사이에 맺어진 웹소켓 같은 지속성 연결도 끊어진다.</p><p>이러한 경우 <strong>사용자를 오프라인 상태로 표시하고 연결이 복구되면 온라인 상태로 변경</strong>하는 방법을 고려할 수 있지만, 짧은 시간 동안 인터넷 연결이 끊어졌다 복귀되는 현상이 흔하기 때문에 적절하지 않다.</p><ul><li>이런 현상마다 사용자의 접속 상태를 변경하는 것은 지나치며, 사용자 경험 측면에서도 바람직하지 않다.</li></ul><p>이에 따라 <strong>박동(heartbeat) 검사</strong>를 통해 이 문제를 해결한다.</p><p><img src=/post/system-design-interview/12/img_15.png width=753 height=620 srcset="/post/system-design-interview/12/img_15_hu870405f6db98088b77813163c0a21c89_78387_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_15_hu870405f6db98088b77813163c0a21c89_78387_1024x0_resize_box_3.png 1024w" loading=lazy alt="박동 검사" class=gallery-image data-flex-grow=121 data-flex-basis=291px></p><ol><li>온라인 상태의 클라이언트로 하여금 주기적으로 박동 이벤트를 접속상태 서버로 보낸다.</li><li>마지막 이벤트를 받은 지 x초 이내에 또 다른 박동 이벤트 메시지를 받으면 해당 사용자의 접속 상태를 계속 온라인으로 유지한다.</li></ol><h3 id=상태-정보의-전송>상태 정보의 전송</h3><p>상태정보 서버는 각각의 친구관게마다 채널을 하나씩 두는 발행-구독 모델을 사용한다.</p><p><img src=/post/system-design-interview/12/img_16.png width=844 height=399 srcset="/post/system-design-interview/12/img_16_huda3d97a35351d5c19e5533f1c287c481_139268_480x0_resize_box_3.png 480w, /post/system-design-interview/12/img_16_huda3d97a35351d5c19e5533f1c287c481_139268_1024x0_resize_box_3.png 1024w" loading=lazy alt="상태 정보 전송" class=gallery-image data-flex-grow=211 data-flex-basis=507px></p><p>이러한 구조를 통해 친구 관계에 있는 사용자가 상태정보 변화를 쉽게 통지 받을 수 있게 된다(웹소켓 사용).</p><p>이러한 방안은 그룹의 크기가 커지면 비용이나 시간이 많이 들게되므로 좋지 않다.</p><ul><li>그룹 하나의 100,000명이 있다면, 상태변화 1건당 100,000개의 이벤트 메시지가 발생한다.</li></ul><p>이런 성능 문제를 해소하는 방법은</p><ul><li>사용자가 그룹 채팅에 입장하는 순간에만 상태 정보를 읽어가게 만든다.</li><li>친구 리스트에 있는 사용자의 접속상태를 갱신하고 싶으면 수동으로 하도록 유도한다.</li></ul><h2 id=4단계-마무리>4단계: 마무리</h2><p>1:1 채팅과 그룹 채팅을 전부 지원하는 채팅 시스템의 아키텍처를 살펴보았다.</p><ul><li>클라이언트와 서버 사이의 통신을 가능하도록 하기 위해 웹소켓을 사용했다.</li><li>주요 컴포넌트<ul><li>실시간 메시징을 지원하는 채팅 서버</li><li>접속 상태 서버</li><li>푸시 알림 서버</li><li>채팅 이력을 보관할 키-값 저장소</li><li>이를 제외한 나머지 기을을 구현하는 데 쓰을 API 서버 등</li></ul></li></ul><p>시간이 남는다면 다음과 같은 내용을 논의해도 좋다.</p><ul><li>사진이나 비디오 등의 미디어를 지원하도록 하는 방법<ul><li>압축 방식, 클라우드 저장소, 섬네일 생성 등</li></ul></li><li>종단 간 암호화</li><li>캐시<ul><li>이미 읽은 메시지를 캐시해 두면 서버와 주고받는 데이터 양을 줄일 수 있다.</li></ul></li><li>로딩 속도 개선<ul><li>슬랙은 사용자의 데이터, 채널 등을 지역적으로 분산하는 네트워크를 구축하여 앱 로딩 속도를 개선하였다.</li></ul></li><li>오류 처리<ul><li>채팅 서버 오류<ul><li>서버 하나가 죽으면 서비스 탐색 기능이 동작하여 클라이언트에게 새로운 서버를 배정하고 다시 접속할 수 있도록 한다.</li></ul></li><li>메시지 재전송<ul><li>재시도나 큐는 메시지의 안정적 전송을 보장하기 위해 흔히 사용되는 기법이다.</li></ul></li></ul></li></ul></section><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
</script><footer class=article-footer><section class=article-tags><a href=/tags/%EA%B0%80%EC%83%81-%EB%A9%B4%EC%A0%91-%EC%82%AC%EB%A1%80%EB%A1%9C-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EB%8C%80%EA%B7%9C%EB%AA%A8-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%84%A4%EA%B3%84-%EA%B8%B0%EC%B4%88/>가상 면접 사례로 배우는 대규모 시스템 설계 기초</a>
<a href=/tags/system-design-interview/>System Design Interview</a>
<a href=/tags/%EC%B1%84%ED%8C%85-%EC%8B%9C%EC%8A%A4%ED%85%9C/>채팅 시스템</a>
<a href=/tags/chat-system/>Chat System</a>
<a href=/tags/%ED%8F%B4%EB%A7%81/>폴링</a>
<a href=/tags/polling/>Polling</a>
<a href=/tags/%EB%A1%B1-%ED%8F%B4%EB%A7%81/>롱 폴링</a>
<a href=/tags/long-pooling/>Long pooling</a>
<a href=/tags/%EC%83%81%ED%83%9C-%EC%9C%A0%EC%A7%80-%EC%84%9C%EB%B9%84%EC%8A%A4/>상태 유지 서비스</a>
<a href=/tags/stateful-service/>Stateful Service</a>
<a href=/tags/%EC%8B%A4%EC%8B%9C%EA%B0%84-%EC%84%9C%EB%B9%84%EC%8A%A4/>실시간 서비스</a>
<a href=/tags/real-time-service/>Real-Time Service</a>
<a href=/tags/%EC%9B%B9%EC%86%8C%EC%BC%93/>웹소켓</a>
<a href=/tags/websocket/>Websocket</a>
<a href=/tags/%EB%A9%94%EC%8B%9C%EC%A7%80%ED%81%90/>메시지큐</a>
<a href=/tags/message-queue/>Message Queue</a>
<a href=/tags/%ED%82%A4-%EA%B0%92-%EC%A0%80%EC%9E%A5%EC%86%8C/>키-값 저장소</a>
<a href=/tags/key-value-store/>Key-value Store</a>
<a href=/tags/%EB%B0%9C%ED%96%89-%EA%B5%AC%EB%8F%85-%EB%AA%A8%EB%8D%B8/>발행 구독 모델</a>
<a href=/tags/publish-subscribe-model/>Publish-subscribe Model</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><div class="article-list--compact links"><article><a href=https://product.kyobobook.co.kr/detail/S000001033116 target=_blank rel=noopener><div class=article-details><h2 class=article-title>가상 면접 사례로 배우는 대규모 시스템 설계 기초</h2><footer class=article-time>교보문고</footer></div></a></article></div><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/system-design-interview-2/10/><div class=article-image><img src=/post/system-design-interview-2/10/cover.eb0176bd1597a4b4423be0cc9ee612d7_huf565d8fe7a4f9f5a961306624616abfc_449360_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 10. 실시간 게임 순위표" data-key=system-design-interview-2/10 data-hash="md5-6wF2vRWXpLRCO+DMnuYS1w=="></div><div class=article-details><h2 class=article-title>10. 실시간 게임 순위표</h2></div></a></article><article class=has-image><a href=/post/system-design-interview-2/4/><div class=article-image><img src=/post/system-design-interview-2/4/cover.eb0176bd1597a4b4423be0cc9ee612d7_huf565d8fe7a4f9f5a961306624616abfc_449360_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 4. 분산 메시지 큐" data-key=system-design-interview-2/4 data-hash="md5-6wF2vRWXpLRCO+DMnuYS1w=="></div><div class=article-details><h2 class=article-title>4. 분산 메시지 큐</h2></div></a></article><article class=has-image><a href=/post/system-design-interview-2/2/><div class=article-image><img src=/post/system-design-interview-2/2/cover.eb0176bd1597a4b4423be0cc9ee612d7_huf565d8fe7a4f9f5a961306624616abfc_449360_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 2. 주변 친구" data-key=system-design-interview-2/2 data-hash="md5-6wF2vRWXpLRCO+DMnuYS1w=="></div><div class=article-details><h2 class=article-title>2. 주변 친구</h2></div></a></article><article class=has-image><a href=/post/system-design-interview/6/><div class=article-image><img src=/post/system-design-interview/6/cover.19a01050cbb7e15d6051c06331fb6a04_huebcf5dd667df9af228f80687035dfdfb_164704_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 6. 키-값 저장소 설계" data-key=system-design-interview/6 data-hash="md5-GaAQUMu34V1gUcBjMftqBA=="></div><div class=article-details><h2 class=article-title>6. 키-값 저장소 설계</h2></div></a></article><article class=has-image><a href=/post/websocket-scale-out/><div class=article-image><img src=/post/websocket-scale-out/cover.fad2ec1ed7696f2930721d83141e07b7_hu9514b00f9971266d18374bc0654f0c59_139764_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 웹소켓 시스템의 성능 개선하기" data-key=websocket-scale-out data-hash="md5-+tLsHtdpbykwch2DFB4Htw=="></div><div class=article-details><h2 class=article-title>웹소켓 시스템의 성능 개선하기</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=codemario318/codemario318.github.io issue-term=pathname label=Comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 Mario Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>