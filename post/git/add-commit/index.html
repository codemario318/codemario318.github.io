<!doctype html><html lang=ko dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=".git을 파헤쳐보자"><title>Git 객체로 살펴보는 add와 commit</title><link rel=canonical href=https://codemario318.github.io/post/git/add-commit/><link rel=stylesheet href=/scss/style.min.cbce94e2760d14d60414e59d5a36ab2819232375817e010dbe7be2234b67da1b.css><meta property="og:title" content="Git 객체로 살펴보는 add와 commit"><meta property="og:description" content=".git을 파헤쳐보자"><meta property="og:url" content="https://codemario318.github.io/post/git/add-commit/"><meta property="og:site_name" content="Mario Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="깃"><meta property="article:tag" content="Git"><meta property="article:tag" content="깃허브"><meta property="article:tag" content="Github"><meta property="article:tag" content="깃랩"><meta property="article:tag" content="Gitlab"><meta property="article:tag" content="버전 관리 시스템"><meta property="article:tag" content="VCS"><meta property="article:tag" content="Version Control System"><meta property="article:tag" content="분산형 버전 관리 시스템"><meta property="article:tag" content="DVCS"><meta property="article:tag" content="Distributed Version Control System"><meta property="article:tag" content="git init"><meta property="article:tag" content="git add"><meta property="article:tag" content="git commit"><meta property="article:published_time" content="2024-07-31T13:17:42+09:00"><meta property="article:modified_time" content="2024-07-31T13:17:42+09:00"><meta property="og:image" content="https://codemario318.github.io/post/git/add-commit/cover.png"><meta name=twitter:title content="Git 객체로 살펴보는 add와 commit"><meta name=twitter:description content=".git을 파헤쳐보자"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codemario318.github.io/post/git/add-commit/cover.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-K99591YLGK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K99591YLGK",{anonymize_ip:!1})}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3183752545292673" crossorigin=anonymous></script><meta name=naver-site-verification content="2315bde85c86f66092140cc465c340a2170f3187"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu760fd15c5fbb2f30cf0868dc4a5dc41a_14271_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Mario Blog</a></h1><h2 class=site-description></h2></div></header><ol class=social-menu><li><a href=https://github.com/codemario318 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><ul class="menu sub-menu"><li><a href=/categories/backend/><span>Backend</span>
<span class=content-count>3</span></a></li><li><a href=/categories/boostcamp/><span>부스트캠프</span>
<span class=content-count>11</span></a></li><li><a href=/categories/cleancode/><span>Clean Code</span>
<span class=content-count>10</span></a></li><li><a href=/categories/common/><span>Common</span>
<span class=content-count>76</span></a></li><li><a href=/categories/data/><span>Data</span>
<span class=content-count>3</span></a></li><li><a href=/categories/db/><span>DB</span>
<span class=content-count>1</span></a></li><li><a href=/categories/frontend/><span>Frontend</span>
<span class=content-count>10</span></a></li><li><a href=/categories/golang/><span>GoLang</span>
<span class=content-count>13</span></a></li><li><a href=/categories/headfirstdesignpatterns/><span>헤드 퍼스트 디자인 패턴</span>
<span class=content-count>22</span></a></li><li><a href=/categories/infra/><span>Infra</span>
<span class=content-count>14</span></a></li><li><a href=/categories/nest/><span>Nest</span>
<span class=content-count>1</span></a></li><li><a href=/categories/network/><span>네트워크</span>
<span class=content-count>1</span></a></li><li><a href=/categories/node/><span>Node</span>
<span class=content-count>6</span></a></li><li><a href=/categories/others/><span>Others</span>
<span class=content-count>1</span></a></li><li><a href=/categories/problemsolving/><span>Problem Solving</span>
<span class=content-count>1</span></a></li><li><a href=/categories/project/><span>Project</span>
<span class=content-count>5</span></a></li><li><a href=/categories/realmysql/><span>Real MySQL</span>
<span class=content-count>53</span></a></li></ul><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#git-객체>Git 객체</a><ol><li><a href=#git-객체의-이름-상태가>Git 객체의 이름 상태가&mldr;?</a></li><li><a href=#내용물은>내용물은?</a></li><li><a href=#git-객체의-종류>Git 객체의 종류</a></li></ol></li><li><a href=#git-add><code>git add</code></a><ol><li><a href=#파일의-추적-상태>파일의 추적 상태</a></li><li><a href=#git에서-일어나는-일><code>.git</code>에서 일어나는 일</a></li><li><a href=#index><strong><code>index</code></strong></a></li></ol></li><li><a href=#git-commit><code>git commit</code></a><ol><li><a href=#tree-객체의-구성><code>Tree</code> 객체의 구성</a></li><li><a href=#commit-객체의-구성><code>Commit</code> 객체의 구성</a></li><li><a href=#요약>요약</a></li></ol></li><li><a href=#마무리>마무리</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/git/add-commit/><img src=/post/git/add-commit/cover_hu0ffdedd87fe527cd0e06241af048622e_24934_800x0_resize_box_3.png srcset="/post/git/add-commit/cover_hu0ffdedd87fe527cd0e06241af048622e_24934_800x0_resize_box_3.png 800w, /post/git/add-commit/cover_hu0ffdedd87fe527cd0e06241af048622e_24934_1600x0_resize_box_3.png 1600w" width=800 height=518 loading=lazy alt="Featured image of post Git 객체로 살펴보는 add와 commit"></a></div><div class=article-details><header class=article-category><a href=/categories/common/ style=background-color:#2a9d8f;color:#fff>Common</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/git/add-commit/>Git 객체로 살펴보는 add와 commit</a></h2><h3 class=article-subtitle>.git을 파헤쳐보자</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2024/07/31</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>9 minute read</time></div></footer></div></header><section class=article-content><p><strong>Git</strong>은 분산형 버전 관리 시스템(Distributed Version Control System, DVCS)으로, 소스 코드와 파일의 변경 이력을 관리하는 도구입니다.</p><p><strong>Git</strong>을 활용하려면 원하는 디렉토리 경로에 <code>git init</code> 명령을 실행하게되는데, 이때 <code>.git</code> 디렉토리가 만들어집니다.</p><p><img src=/post/git/add-commit/img_1.png width=471 height=311 srcset="/post/git/add-commit/img_1_hu2a5eb33a792f1a5359f11c4937882c21_37732_480x0_resize_box_3.png 480w, /post/git/add-commit/img_1_hu2a5eb33a792f1a5359f11c4937882c21_37732_1024x0_resize_box_3.png 1024w" loading=lazy alt=".git 내부 구조" class=gallery-image data-flex-grow=151 data-flex-basis=363px></p><p>이 때 만들어지는 <code>.git</code> 디렉토리는 저장소(repository)의 <strong>메타데이터</strong>와 <strong>Git 객체</strong>들을 저장하는 장소이며, 그 중 <strong>Git 객체</strong>는 저장소의 데이터를 관리하고 추적하는데 핵심입니다.</p><p><strong>Git</strong>은 <strong>Git 객체</strong>와 워킹 디렉토리의 파일들을 기준으로 변경을 감지하고, <code>Git 객체</code>의 정보를 통해 코드의 버전들을 관리하고 추적하게됩니다.</p><p>이를 조금 더 자세히 살펴보겠습니다.</p><h2 id=git-객체>Git 객체</h2><p><code>.git</code> 디렉토리 아래에 있는 <code>/objects</code> 디렉토리에 파일로 저장되는 <strong>Git 객체</strong>는 Git의 핵심으로, 모든 데이터의 내용과 실제 저장 위치를 의미하게 됩니다.</p><p>실제 <code>/objects</code>의 경로를 확인하면 아래와 같은 구조를 확인할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/objects
</span></span><span class=line><span class=cl>├── 0d
</span></span><span class=line><span class=cl>│   └── df0ae059b771e502af67931f9f8a4a17632661
</span></span><span class=line><span class=cl>├── 24
</span></span><span class=line><span class=cl>│   └── 643cc37449b4bde54411a80b8ed61258225e34
</span></span><span class=line><span class=cl>├── 35
</span></span><span class=line><span class=cl>│   └── eb1ddfbbc029bcab630581847471d7f238ec53
</span></span><span class=line><span class=cl>├── 6c
</span></span><span class=line><span class=cl>│   └── 435e543633035641c810e97681b078d627a946
</span></span><span class=line><span class=cl>├── a6
</span></span><span class=line><span class=cl>│   └── d422786b4daf0d8cbd7466a02e4a4fa9fd8570
</span></span><span class=line><span class=cl>├── b1
</span></span><span class=line><span class=cl>│   └── 7d46df496e1a6aef89fc6d67937a2ba47b5d33
</span></span><span class=line><span class=cl>├── info
</span></span><span class=line><span class=cl>└── pack
</span></span><span class=line><span class=cl>    ├── pack-15a971ce7fbb8c9997e7e167347a23bbfe438d71.idx
</span></span><span class=line><span class=cl>    └── pack-15a971ce7fbb8c9997e7e167347a23bbfe438d71.pack
</span></span></code></pre></td></tr></table></div></div><p>파일의 경로가 <strong>2글자로 시작하는 디렉토리</strong> 아래에 <strong>불특정한 38자 이름</strong>을 가진 파일이 저장되어있는데, 이 저장된 파일이 <strong>Git 객체</strong>입니다.</p><h3 id=git-객체의-이름-상태가>Git 객체의 이름 상태가&mldr;?</h3><p>저장되는 파일 이름을 보시면 어느정도 눈치 채셨을 것 같은데요.</p><p><code>Git</code> 객체가 위치와 이름은 총 40자, 16진수 문자열로 파일의 전체 내용을 <code>SHA-1</code> 함수로 해싱한 결과입니다.</p><p>이로인해 파일 내용의 무결성을 보장함은 물론 파일을 거의 유일하게 식별할 수 있습니다.</p><p>해시값을 사용하는 이유는 파일의 내용이 변경되면 아예 다른 결과가 반환되는 해시 함수의 특징을 활용해 <strong>파일의 변경</strong>을 간편하게 확인하기 위함입니다.</p><p>파일 내용이 <code>e69de29bb2d1d6434b8b29ae775ad8c2e48c5391</code> 해시 값을 가진다면, <code>.git/objects/e6/9de29bb2d1d6434b8b29ae775ad8c2e48c5391</code>에 저장됩니다.</p><p>앞에 2자를 분리해 굳이 디렉토리로 만든 이유는 2가지 정도로 확인됩니다.</p><ul><li>성능 최적화<ul><li>한 디렉토리 내에 너무 많은 파일을 저장하면 성능이 저하됨</li><li>수천 개 또는 수십만 개 파일을 하나의 디렉토리에 저장하면 검색, 파일 생성 및 접근 속도가 느려질 수 있음</li><li>객체들을 고르게 분산하여 저장할 수 있어 성능 저하를 방지할 수 있음</li></ul></li><li>관리 용이<ul><li>디렉토리 구조로 나눔으로써 객체 파일을 관리하고 탐색하는 것이 더 쉬워짐(2자로 디렉터리를 바로 찾을 수 있음)</li></ul></li></ul><h3 id=내용물은>내용물은?</h3><p>문서 혹은 파일의 내용으로 만들어지는 해시값을 경로로 저장되는 Git 객체 파일에는 해시값을 만드는데 사용하기도 했던 파일의 전체 내용을 압축하여 저장합니다.</p><h3 id=git-객체의-종류>Git 객체의 종류</h3><p><strong>Git 객체</strong>는 3가지 유형이 존재합니다.</p><ul><li>파일의 저장 경로와 파일의 내용은 모두 위와 동일하게 만들어집니다.</li></ul><hr><p><strong>블롭(<code>Blob</code>)</strong></p><ul><li>파일의 내용 자체를 저장</li><li>파일의 이름이나 메타데이터는 저장하지 않고 파일의 원본 내용만 저장함</li></ul><p>블롭 유형의 파일은 데이터 원본의 내용만을 압축하여 저장합니다.</p><p>압축하여 저장된 원본 데이터는 복구 등의 처리에서 활용됩니다.</p><hr><p><strong>트리(<code>Tree</code>)</strong></p><ul><li>디렉터리의 구조를 저장</li><li>디렉터리의 파일 및 하위 디렉터리와 그에 대한 블롭 객체 객체의 참조를 포함(트리는 블롭과 또 다른 트리로 구성됨)</li></ul><p>트리 객체를 통해 디렉토리 구조를 관리할 수 있게 됩니다.</p><p>트리 객체가 의미하는 디렉토리의 존재하는 모든 <strong>파일</strong>, <strong>디렉토리</strong>들의 경로(파일 주소)를 Git 객체의 값으로 압축하여 저장하게 됩니다.</p><hr><p><strong>커밋(<code>Commit</code>)</strong></p><ul><li>커밋 정보를 저장</li><li>커밋 메시지, 작성자, 날짜 및 커밋 시점의 트리 객체를 포함</li></ul><p>직전 루트 트리 객체의 주소(파일 경로), 현재 루트 트리 객체의 주소(파일 경로)와 커밋 메시지 등 메타데이터를이 압축되어 저장됩니다.</p><h2 id=git-add><code>git add</code></h2><p><code>git add</code> 명령어는 작업 디렉토리에서 변경된 파일들을 스테이징 영역에 추가하여 다음 커밋에 포함될 파일들을 준비하게됩니다.</p><ul><li><p><strong>작업 디렉토리</strong></p><ul><li>사용자가 작업 중인 실제 파일들이 존재하는 디렉토리</li></ul></li><li><p><strong>인덱스(스테이징 영역)</strong></p><ul><li>커밋을 준비하기 위해 변경된 파일들이 추가되는 영역</li><li>인덱스는 <code>.git/index</code> 파일에 저장됨</li></ul></li></ul><p>먼저 변경된 파일들을 어떻게 관리하는지 확인해보겠습니다.</p><h3 id=파일의-추적-상태>파일의 추적 상태</h3><p><img src=/post/git/add-commit/img.png width=800 height=330 srcset="/post/git/add-commit/img_hu0d2cd540fc510e4ec1c1a61158d3600f_25950_480x0_resize_box_3.png 480w, /post/git/add-commit/img_hu0d2cd540fc510e4ec1c1a61158d3600f_25950_1024x0_resize_box_3.png 1024w" loading=lazy alt="파일 상태 변화" class=gallery-image data-flex-grow=242 data-flex-basis=581px></p><p>Git은 작업 디렉토리의 파일을 4가지 상태로 추적, 관리합니다.</p><ul><li><code>UnTracked</code>: 추적되지 않는 파일<ul><li>Git에 등록되지않아 추적되지 않는 상태</li><li>Git이 버전 관리하고 있지 않은 파일</li><li>새로 생성된 파일이거나, 추적되지 않도록 명시적으로 설정된 파일(.gitignore)</li></ul></li><li><code>Unmodified</code>: 수정되지 않은 파일<ul><li>Git이 추적하고 있는 파일이지만, 마지막 커밋 이후 변경되지 않은 상태</li></ul></li><li><code>Modified</code>: 수정된 파일<ul><li>Git이 추적하고 있는 파일이지만, 마지막 커밋 이후로 파일의 내용이 변경된 상태</li></ul></li><li><code>Staged</code>: 스테이징된 파일<ul><li><code>git add</code> 명령을 통해 스테이징 영역에 추가된 상태</li><li>다음 커밋에 포함될 준비가 되었다는 의미</li></ul></li></ul><hr><p><strong><code>Untracked</code> -> <code>Staged</code></strong></p><p>Git으로 관리되고 있는 프로젝트에 처음 생성된 파일은 <code>UnTracked</code> 상태입니다. 즉 Git이 추적하고 있지 않은 상태임을 의미합니다.</p><p><code>git add</code> 명령을 수행하면 해당 파일이 스태이징 영역에 추가되며 <code>Staged</code> 상태로 변경됩니다.</p><hr><p><strong><code>Unmodified</code> -> <code>Modified</code></strong></p><p>Git을 통해 추적하고 있지만, 마지막 변경 이후 수정되지 않았다면 <code>Unmodifed</code> 상태입니다.</p><p><code>Unmodifed</code> 상태의 파일에 변경이 발생하면(이전과 다른 부분이 발생하면) <code>Modifed</code> 상태가 됩니다.</p><hr><p><strong><code>Modified</code> -> <code>Staged</code></strong></p><p><code>Unmodified</code> 상태인 파일에 변경이 발생하여 <code>Modifed</code> 상태가 되었을 때 <code>git add</code> 명령로 스테이징 영역에 추가할 수 있습니다.</p><h3 id=git에서-일어나는-일><code>.git</code>에서 일어나는 일</h3><p>이제는 <code>.git</code> 내부에 어떤 일들이 발생하는지 살펴보겠습니다.</p><ol><li><strong>변경된 파일의 해시 계산</strong></li></ol><ul><li><code>git add</code> 명령어가 실행되면, Git은 현재 인덱스 파일(<code>.git/index</code>)의 기록된 정보를 활용하여 작업 디렉토리에서 변경된 파일의 내용을 찾아 읽습니다.<ul><li><code>Untracked</code>, <code>Modified</code></li></ul></li><li>변경된 파일의 내용을 기반으로 SHA-1 해시를 계산하여 고유한 해시 값을 생성합니다.(Git 객체의 이름, 저장될 경로)</li></ul><ol start=2><li><strong>객체 생성 및 저장</strong></li></ol><ul><li>생성된 해시값을 이용하여 파일의 내용을 Git 객체로 저장합니다.(Blob)<ul><li>Blob 객체는 파일의 바이너리 데이터를 담고 있으며, <code>.git/obects</code> 디렉토리에 저장</li><li>저장 경로는 해시값의 처음 두자리를 디렉토리 이름으로 사용하고, 나머지 38자리를 파일 이름으로 사용하여 저장</li></ul></li></ul><ol start=3><li><strong>인덱스 업데이트</strong><ul><li>Blob 객체가 생성되고 저장된 후, Git은 인덱스 파일(<code>.git/index</code>)을 업데이트합니다.<ul><li>파일의 모드, 해시 값, 파일 이름 등을 기록합니다.</li></ul></li></ul></li></ol><h3 id=index><strong><code>index</code></strong></h3><p><code>index</code> 파일은 <code>stage</code> 영역에 있는 파일들 즉 작업 디렉토리 내 추적중인 파일을 의미하며, 다음 <code>commit</code>에 포함될 파일의 정보들을 의미하게됩니다.</p><p>만약 <code>git init</code> 명령을 수행하고 <code>README.md</code>와 <code>src/index.js</code>를 추가한 후 <code>git add</code> 명령을 수행했다면 <code>.git/index</code> 파일의 내용은 아래와 같이 수정됩니다.(해시 값은 임의로 설정하였습니다.)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>100644 e69de29bb2d1d6434b8b29ae775ad8c2e48c5391 0 README.md
</span></span><span class=line><span class=cl>100644 24643cc37449b4bde54411a80b8ed61258225e34 0 src/index.js
</span></span></code></pre></td></tr></table></div></div><p>띄어쓰기로 구분되는 각 요소는 <code>파일 모드</code>, <code>해시값</code>, <code>스테이지 번호</code>, <code>파일 경로</code>를 의미합니다.</p><p>여기서 주의해야할 점은 <code>.git/index</code>에는 <code>Blob</code> 객체만 저장된다는 점 입니다.</p><hr><p><strong>파일 모드</strong></p><p>맨 앞의 <code>100644</code>는 파일 식별자로 흔히 알려진 파일의 권한을 포함하게됩니다.</p><p>그 역할은 아래와 같습니다.</p><ul><li>읽기, 쓰기 파일(블롭): <code>100644</code> (<code>chmod 644</code>)</li><li>실행 파일(블롭): <code>100755</code> (<code>chmod 755</code>)</li><li>디렉터리(트리): <code>040000</code></li></ul><p><code>.git/index</code>는 <code>Blob</code> 객체 정보만 관리하므로 읽기 파일, 실행 파일만 저장됩니다.</p><p><code>Tree</code> 객체를 를 의미하는 <code>040000</code>는 이후 커밋에 활용됩니다.</p><hr><p><strong>스테이지 번호</strong></p><p>스테이지 번호는 병합 충돌 시 사용되는 필드입니다. 파일이 정상적으로 추가되었을 때는 <code>0</code> 입니다.</p><ul><li>0: 기본 스테이지. 충돌이 없는 파일이 여기에 위치합니다.</li><li>1: 공통 조상 (ancestor) 버전.</li><li>2: 현재 브랜치 (our) 버전.</li><li>3: 병합하려는 브랜치 (their) 버전.</li></ul><hr><p><strong><code>.git/index</code>의 역할</strong></p><p>인덱스 파일의 역할을 정리해보면 아래와 같습니다.</p><ul><li>인덱스 파일은 다음 커밋에 포함될 파일들을 추적합니다.</li><li>인덱스에 추가된 파일들은 다음 <code>git commit</code> 명령어가 실행될 때 커밋 히스토리에 포함됩니다.</li></ul><h2 id=git-commit><code>git commit</code></h2><p><code>git commit</code> 명령어가 실행되었을 때 어떤 흐름이 발생하는지 확인해보겠습니다.</p><ol><li><code>Tree</code> 객체 생성<ul><li>인덱스 파일에 기록된 내용을 바탕으로 트리 객체가 생성됩니다.</li><li>트리 객체는 디렉토리 구조와 파일 정보를 담고 있으며, 각 파일은 <code>Blob</code> 객체와 <code>Tree</code> 객체를 가리킵니다.</li></ul></li><li><code>Commit</code> 객체 생성<ul><li>트리 객체가 생성된 후, 커밋 객체가 생성됩니다.<ul><li>트리 객체의 해시 값</li><li>부모 커밋(이전 커밋)의 해시 값(최초 커밋인 경우 제외)</li><li>커밋 메시지</li><li>작성자와 커미터 정보(이름, 이메일, 타임스탬프 등)</li></ul></li></ul></li><li>객체 저장 및 참조 업데이트<ul><li>객체 저장<ul><li>생성된 커밋 객체와 트리 객체는 <code>.git/objects</code> 디렉토리에 저장됩니다.</li><li><code>Blob</code> 객체와 마찬가지로 각 객체는 해시값을 기반으로 저장됩니다.</li></ul></li><li>참조 업데이트<ul><li>새로운 커밋 객체가 생성되면, 현재 브랜치의 참조가 새로운 커밋을 가리키도록 업데이트 합니다.<ul><li>현재 브랜치의 참조는 <code>.git/refs/heads/&lt;브랜치 이름></code> 파일에 저장</li><li><code>main</code>인 경우 <code>.git/refs/heads/main</code> 파일의 내용이 새로운 커밋의 해시값으로 업데이트</li></ul></li></ul></li></ul></li></ol><p>새 커밋이 생성되면서 Git은 버전 히스토리를 관리합니다.</p><p>각 커밋 객체는 이전 커밋 객체(부모 객체)를 가르키며, 이를 통해 커밋 히스토리가 마치 <strong>연결 리스트</strong> 형태로 구성됩니다.</p><h3 id=tree-객체의-구성><code>Tree</code> 객체의 구성</h3><p>처음 <code>git commit</code> 명령이 수행되면 작업 디렉토리를 기반으로 트리 객체를 만들게됩니다.</p><p>트리 객체는 특정 디렉터리 내부에 포함되는 모든 파일(<code>Blob</code> 객체), 디렉토리(<code>Tree</code> 객체)의 해시값을 내용으로 가지며, 작업 디렉토리가 아래와 같은 구조를 가진다고 가정하고 내부 구조를 확인해보겠습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>project/
</span></span><span class=line><span class=cl>├── README.md
</span></span><span class=line><span class=cl>└── src/
</span></span><span class=line><span class=cl>    └── index.js
</span></span></code></pre></td></tr></table></div></div><p>작업 디렉터리의 루트 <code>Tree</code> 객체는 아래와 같은 내용을 가지게됩니다.(해시값은 임의로 작성하였습니다.)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>100644 blob e69de29bb2d1d6434b8b29ae775ad8c2e48c5391 README.md
</span></span><span class=line><span class=cl>040000 tree d8329fc1cc938780ffdd9f94e0d364e0ea0ea1e1 src
</span></span></code></pre></td></tr></table></div></div><p><code>src</code> 디렉토리를 의미하는 <code>Tree</code> 객체는 아래와 같은 내용을 가집니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>100644 24643cc37449b4bde54411a80b8ed61258225e34 index.js
</span></span></code></pre></td></tr></table></div></div><p>각 내용들이 디렉토리를 구성하는 <code>Git</code> 객체의 주소값을 가르키게됩니다.</p><h3 id=commit-객체의-구성><code>Commit</code> 객체의 구성</h3><p><code>Tree</code> 객체가 만들어지면 작업 디렉토리의 <code>Tree</code> 객체(루트 <code>Tree</code> 객체)의 주소를 이용하여 <code>Commit</code> 객체를 만들게됩니다.</p><p><code>Commit</code> 객체의 내용에는 작업 디렉토리의 루트 <code>Tree</code> 객체의 해시값, 부모 커밋의 해시값, 커밋 메시지, 작성자와 커밋터의 정보가 담깁니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>tree &lt;작업 디렉토리의 Tree 객체의 해시 값&gt;
</span></span><span class=line><span class=cl>parent &lt;이전 커밋의 해시 값(첫 커밋이라면 생략)&gt;
</span></span><span class=line><span class=cl>author John Doe &lt;john.doe@example.com&gt; 1609459200 +0000
</span></span><span class=line><span class=cl>committer John Doe &lt;john.doe@example.com&gt; 1609459200 +0000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;커밋 메시지&gt;
</span></span></code></pre></td></tr></table></div></div><h3 id=요약>요약</h3><ul><li><code>git commit</code> 명령어는 스테이징 영역의 파일들을 기반으로 트리 객체를 생성하고, 이를 참조하는 커밋 객체를 생성합니다.</li><li>생성된 커밋 객체는 <code>.git/objects</code> 디렉토리에 저장되며, 현재 브랜치의 참조가 새로운 커밋 객체를 가리키도록 업데이트됩니다.</li><li>이 과정은 Git의 분산 버전 관리 시스템이 효율적으로 파일의 변경 이력을 관리하고 추적할 수 있게 합니다.</li></ul><h2 id=마무리>마무리</h2><p>이전부터 <code>.git</code>의 존재는 알았지만, 왜 존재하는지, 어떻게 구성되어있는지, 역할이 뭔지 등에 대해서는 큰 관심이 없었습니다.</p><p>이번 기회를 통해 <code>.git</code>의 내부 파일들(<code>Git</code> 객체)의 상태 변화를 확인하면서 <code>add</code>와 <code>commit</code> 명령이 어떻게 수행되는지 더 깊이 이해할 수 있어 좋은 경험이었네요 😁</p><p>읽어보시고 잘못된 정보나, 이해가 어려운 부분이 있다면 댓글 남겨주세요!</p><p>틀린 내용이 있다면 빠르게 반영하고, 이해가 어려운 부분은 같이 다시 고민해볼 기회가 될 수 있을것 같습니다🔥</p><p>끝까지 읽어주셔서 감사합니다.😊</p></section><footer class=article-footer><section class=article-tags><a href=/tags/%EA%B9%83/>깃</a>
<a href=/tags/git/>Git</a>
<a href=/tags/%EA%B9%83%ED%97%88%EB%B8%8C/>깃허브</a>
<a href=/tags/github/>Github</a>
<a href=/tags/%EA%B9%83%EB%9E%A9/>깃랩</a>
<a href=/tags/gitlab/>Gitlab</a>
<a href=/tags/%EB%B2%84%EC%A0%84-%EA%B4%80%EB%A6%AC-%EC%8B%9C%EC%8A%A4%ED%85%9C/>버전 관리 시스템</a>
<a href=/tags/vcs/>VCS</a>
<a href=/tags/version-control-system/>Version Control System</a>
<a href=/tags/%EB%B6%84%EC%82%B0%ED%98%95-%EB%B2%84%EC%A0%84-%EA%B4%80%EB%A6%AC-%EC%8B%9C%EC%8A%A4%ED%85%9C/>분산형 버전 관리 시스템</a>
<a href=/tags/dvcs/>DVCS</a>
<a href=/tags/distributed-version-control-system/>Distributed Version Control System</a>
<a href=/tags/git-init/>git init</a>
<a href=/tags/git-add/>git add</a>
<a href=/tags/git-commit/>git commit</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><div class="article-list--compact links"><article><a href="https://www.youtube.com/watch?v=KyGfapLpWhY" target=_blank rel=noopener><div class=article-details><h2 class=article-title>지옥에서 온 GIT: 원리</h2><footer class=article-time>생활코딩</footer></div></a></article><article><a href=https://tecoble.techcourse.co.kr/post/2021-07-08-dot-git/ target=_blank rel=noopener><div class=article-details><h2 class=article-title>.git 내부 구조 파헤치기</h2><footer class=article-time>Tecoble</footer></div></a></article></div><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/boostcamp-9th/review/challenge/3/><div class=article-image><img src=/post/boostcamp-9th/review/challenge/3/cover.1a9a8e05cdd87c13be1cd4efdcd8d800_hu19d27c1827c5e9fb407a4e610db031e0_130036_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 챌린지 과정 3주차 회고" data-key=boostcamp-9th/review/challenge/3 data-hash="md5-GpqOBc3YfBO+HNTv3NjYAA=="></div><div class=article-details><h2 class=article-title>챌린지 과정 3주차 회고</h2></div></a></article><article class=has-image><a href=/post/learning-domain-driven-design/2/><div class=article-image><img src=/post/learning-domain-driven-design/2/cover.ab8639e2d4d8b91c870b9d7f00084c49_huc2e2b54770a897ab187a0f935be3b40b_418378_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 전략적 설계: 도메인 지식 찾아내기" data-key=learning-domain-driven-design/2 data-hash="md5-q4Y54tTYuRyHC51/AAhMSQ=="></div><div class=article-details><h2 class=article-title>전략적 설계: 도메인 지식 찾아내기</h2></div></a></article><article class=has-image><a href=/post/designing-data-intensive-application/3/1/><div class=article-image><img src=/post/designing-data-intensive-application/3/1/cover.da37edb5ab5d5614db18429314b2003a_hu03451f961cb1218aaf8d95eea6944999_534781_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 3.1. 저장소와 검색: 데이터베이스를 강력하게 만드는 데이터 구조" data-key=designing-data-intensive-application/3/1 data-hash="md5-2jfttatdVhTbGEKTFLIAOg=="></div><div class=article-details><h2 class=article-title>3.1. 저장소와 검색: 데이터베이스를 강력하게 만드는 데이터 구조</h2></div></a></article><article class=has-image><a href=/post/learning-domain-driven-design/1/><div class=article-image><img src=/post/learning-domain-driven-design/1/cover.ab8639e2d4d8b91c870b9d7f00084c49_huc2e2b54770a897ab187a0f935be3b40b_418378_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 전략적 설계: 비즈니스 도메인 분석하기" data-key=learning-domain-driven-design/1 data-hash="md5-q4Y54tTYuRyHC51/AAhMSQ=="></div><div class=article-details><h2 class=article-title>전략적 설계: 비즈니스 도메인 분석하기</h2></div></a></article><article class=has-image><a href=/post/designing-data-intensive-application/2/3/><div class=article-image><img src=/post/designing-data-intensive-application/2/3/cover.da37edb5ab5d5614db18429314b2003a_hu03451f961cb1218aaf8d95eea6944999_534781_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 2.3 데이터 모델과 질의 언어 - 그래프형 데이터 모델" data-key=designing-data-intensive-application/2/3 data-hash="md5-2jfttatdVhTbGEKTFLIAOg=="></div><div class=article-details><h2 class=article-title>2.3 데이터 모델과 질의 언어 - 그래프형 데이터 모델</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=codemario318/codemario318.github.io issue-term=pathname label=Comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 Mario Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>