<!doctype html><html lang=ko dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="컨테이너 인프라 환경 구축해보기"><title>1. Docker를 이용한 컨테이너 배포</title><link rel=canonical href=https://codemario318.github.io/post/infra/container-env/1/><link rel=stylesheet href=/scss/style.min.cbce94e2760d14d60414e59d5a36ab2819232375817e010dbe7be2234b67da1b.css><meta property="og:title" content="1. Docker를 이용한 컨테이너 배포"><meta property="og:description" content="컨테이너 인프라 환경 구축해보기"><meta property="og:url" content="https://codemario318.github.io/post/infra/container-env/1/"><meta property="og:site_name" content="Mario Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Docker"><meta property="article:published_time" content="2023-08-29T14:52:25+09:00"><meta property="article:modified_time" content="2023-08-29T14:52:25+09:00"><meta property="og:image" content="https://codemario318.github.io/post/infra/container-env/1/cover.png"><meta name=twitter:title content="1. Docker를 이용한 컨테이너 배포"><meta name=twitter:description content="컨테이너 인프라 환경 구축해보기"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codemario318.github.io/post/infra/container-env/1/cover.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-K99591YLGK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K99591YLGK",{anonymize_ip:!1})}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3183752545292673" crossorigin=anonymous></script><meta name=naver-site-verification content="2315bde85c86f66092140cc465c340a2170f3187"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu760fd15c5fbb2f30cf0868dc4a5dc41a_14271_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Mario Blog</a></h1><h2 class=site-description></h2></div></header><ol class=social-menu><li><a href=https://github.com/codemario318 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><ul class="menu sub-menu"><li><a href=/categories/backend/><span>Backend</span>
<span class=content-count>3</span></a></li><li><a href=/categories/boostcamp/><span>부스트캠프</span>
<span class=content-count>5</span></a></li><li><a href=/categories/cleancode/><span>Clean Code</span>
<span class=content-count>10</span></a></li><li><a href=/categories/common/><span>Common</span>
<span class=content-count>57</span></a></li><li><a href=/categories/data/><span>Data</span>
<span class=content-count>3</span></a></li><li><a href=/categories/db/><span>DB</span>
<span class=content-count>1</span></a></li><li><a href=/categories/frontend/><span>Frontend</span>
<span class=content-count>10</span></a></li><li><a href=/categories/golang/><span>GoLang</span>
<span class=content-count>13</span></a></li><li><a href=/categories/headfirstdesignpatterns/><span>헤드 퍼스트 디자인 패턴</span>
<span class=content-count>22</span></a></li><li><a href=/categories/infra/><span>Infra</span>
<span class=content-count>14</span></a></li><li><a href=/categories/network/><span>네트워크</span>
<span class=content-count>1</span></a></li><li><a href=/categories/node/><span>Node</span>
<span class=content-count>1</span></a></li><li><a href=/categories/problemsolving/><span>Problem Solving</span>
<span class=content-count>1</span></a></li><li><a href=/categories/project/><span>Project</span>
<span class=content-count>5</span></a></li><li><a href=/categories/realmysql/><span>Real MySQL</span>
<span class=content-count>53</span></a></li></ul><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#준비>준비</a><ol><li><a href=#도커-준비>도커 준비</a></li><li><a href=#프로젝트-준비>프로젝트 준비</a></li><li><a href=#네트워크-환경-준비-공유기-사용시>네트워크 환경 준비 (공유기 사용시)</a></li></ol></li><li><a href=#컨테이너-빌드>컨테이너 빌드</a><ol><li><a href=#프로젝트-빌드>프로젝트 빌드</a></li><li><a href=#dockerfile-작성>Dockerfile 작성</a></li><li><a href=#docker-이미지-빌드>Docker 이미지 빌드</a></li></ol></li><li><a href=#컨테이너-배포>컨테이너 배포</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/infra/container-env/1/><img src=/post/infra/container-env/1/cover_hu2346df674ac5a4d10745571793c062e9_26488_800x0_resize_box_3.png srcset="/post/infra/container-env/1/cover_hu2346df674ac5a4d10745571793c062e9_26488_800x0_resize_box_3.png 800w, /post/infra/container-env/1/cover_hu2346df674ac5a4d10745571793c062e9_26488_1600x0_resize_box_3.png 1600w" width=800 height=336 loading=lazy alt="Featured image of post 1. Docker를 이용한 컨테이너 배포"></a></div><div class=article-details><header class=article-category><a href=/categories/infra/ style=background-color:#2a9d8f;color:#fff>Infra</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/infra/container-env/1/>1. Docker를 이용한 컨테이너 배포</a></h2><h3 class=article-subtitle>컨테이너 인프라 환경 구축해보기</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2023/08/29</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>8 minute read</time></div></footer></div></header><section class=article-content><p>개인적으로 해보고 싶었던 쿠버네티스를 이용하여 컨테이너 인프라 환경을 구축해보려고합니다.</p><p>이전 회사에서 거대한 모놀리식 구조로 운영되던 서비스를 회사 장기 비전인 Java 전환과 MSA 전환을 위해 꼭 필요하다고 졸라서 해보라고 허락을 받고 공부하고 있었는데 결국 퇴사를 하게 되었네요.</p><p>기본적인 내용들은 <a class=link href=https://product.kyobobook.co.kr/detail/S000001834629 target=_blank rel=noopener>컨테이너 인프라 환경 구축을 위한 쿠버네티스/도커</a> 책을 통해 학습하였고, 추가로 참고한 내용들은 따로 공유드리겠습니다.</p><p>컨테이너 인프라 환경을 구축하기 위한 첫 걸음으로 Docker를 이용하여 컨테이너에 배포하는 방법을 알아보겠습니다.</p><h2 id=준비>준비</h2><p>이전에 코프링 찍먹 해보려고 만들었던 프로젝트을 배포하는 실습을 해보겠습니다.</p><h3 id=도커-준비>도커 준비</h3><p>실습을 위해 로컬 환경에 Docker를 설치해야 합니다.</p><p>설치하는 방법은 다양한데 공식 문서를 따라서 차분하게 진행하시면 어렵지 않게 수행하실 수 있으므로 관련 링크만 남깁니다.</p><ul><li><a class=link href=https://docs.docker.com/desktop/install/mac-install/ target=_blank rel=noopener>Install Docker Desktop</a></li></ul><h3 id=프로젝트-준비>프로젝트 준비</h3><p>제가 찍먹을 위해 만들었던 코프링 프로젝트는 스프링 공식 가이드의 <a class=link href=https://spring.io/guides/tutorials/spring-boot-kotlin/ target=_blank rel=noopener>Building web applications with Spring Boot and Kotlin</a>입니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir blog <span class=o>&amp;&amp;</span> <span class=nb>cd</span> blog
</span></span><span class=line><span class=cl>curl https://start.spring.io/starter.zip -d <span class=nv>language</span><span class=o>=</span>kotlin -d <span class=nv>type</span><span class=o>=</span>gradle-project-kotlin -d <span class=nv>dependencies</span><span class=o>=</span>web,mustache,jpa,h2,devtools -d <span class=nv>packageName</span><span class=o>=</span>com.example.blog -d <span class=nv>name</span><span class=o>=</span>Blog -o blog.zip
</span></span></code></pre></td></tr></table></div></div><p>위 명령을 사용하셨다면 Kotlin DSL + Gradle로 빌드할 수 있는 SpringBoot 프로젝트가 아래 구조로 만들어졌을 겁니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── Dockerfile
</span></span><span class=line><span class=cl>├── HELP.md
</span></span><span class=line><span class=cl>├── build
</span></span><span class=line><span class=cl>├── build.gradle.kts
</span></span><span class=line><span class=cl>├── gradle
</span></span><span class=line><span class=cl>├── gradlew
</span></span><span class=line><span class=cl>├── gradlew.bat
</span></span><span class=line><span class=cl>├── settings.gradle.kts
</span></span><span class=line><span class=cl>└── src
</span></span></code></pre></td></tr></table></div></div><p>저는 가이드 문서대로 이미 구현을 한 상태라 추가 작업 없이 확인할 수 있지만, 잘 배포 되었는지 확인하기 위한 간단한 REST 컨트롤러를 만들어주겠습니다.</p><p>패키지 경로 내에 있다면 어떤 이름으로 만들어도 상관은 없습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>package</span> <span class=nn>com.example.blog</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>org.springframework.web.bind.annotation.GetMapping</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>org.springframework.web.bind.annotation.RequestMapping</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>org.springframework.web.bind.annotation.RestController</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@RestController</span>
</span></span><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s2>&#34;/api/hello&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>HelloController</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GetMapping</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>hello</span><span class=p>()</span> <span class=p>=</span> <span class=s2>&#34;Hello&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=네트워크-환경-준비-공유기-사용시>네트워크 환경 준비 (공유기 사용시)</h3><p>저와 같이 공유기를 사용한다면 외부 네트워크에서 정상 동작을 확인하기 위해 추가 설정이 필요합니다. 테스트를 환경이 공유기를 사용하지 않는다면 넘기셔도 좋습니다.</p><p>외부 네트워크를 통해 웹 애플리케이션에 접근하려면 애플리케이션이 배포된 서버의 IP와 웹 애플리케이션이 사용 중인 PORT 정보를 알아야 하는데, 저처럼 공유기를 사용하는 환경에서는 공유기가 IP를 할당 받게 됩니다.</p><blockquote><p>라우터(공유기 등)으로 구성된 내부 네트워크를 서브넷 이라고 하며, 서브넷 자체적으로 내부 IP를 할당하기 때문에 서브넷 내부에서 서로 통신할 수 있습니다.</p></blockquote><p>따라서 공유기에 들어온 요청을 연결된 내부 네트워크를 통해 웹 애플리케이션을 배포한 로컬 환경으로 요청을 전달해야 하는데, 이러한 처리를 포트 포워딩이라고 합니다.</p><p>포트 포워딩은 공유기가 받은 요청을 내부적으로 연결된 목적지에 전달하는 것이기 때문에 요청을 받는 공유기에 설정해야 하고, 대부분 공유기가 이러한 기능을 제공하고 있습니다.</p><p>현재 연결된 무선 인터넷의 IP 정보가 내부 IP이고, 외부 IP는 mac 기준 아래 명령으로 확인할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>curl ifconfig.me
</span></span></code></pre></td></tr></table></div></div><p>공유기 관리자 페이지는 내부 IP에서 마지막이 1로 바꿔 접근하면 됩니다. 저는 같은 경우는 <a class=link href=http://192.168.0.1/ target=_blank rel=noopener>http://192.168.0.1/</a> 이었습니다.</p><p><img src=/post/infra/container-env/1/img_1.png width=882 height=580 srcset="/post/infra/container-env/1/img_1_hu55bf77ff89b873d68649940d5fc61b8f_57370_480x0_resize_box_3.png 480w, /post/infra/container-env/1/img_1_hu55bf77ff89b873d68649940d5fc61b8f_57370_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=152 data-flex-basis=364px></p><p>IpTime 공유기는 이런 식으로 나올 텐데, 구성은 대부분 같습니다.</p><p>외부 IP, 내부 IP 맞춰 입력하고 외부 포트는 포트 포워딩할 대상 포트 번호를 입력하고, 내부 포트는 로컬 환경에서 배포될 컨테이너의 호스트 포트 번호를 입력하면 됩니다.</p><p>외부 포트 같은 경우 http 포트 번호가 80이라서 설정했는데, 8비트 정수값이라면 어떤 값이 들어가도 상관없습니다.</p><p>다만 브라우저를 통해 접근할 때 <code>외부_IP:외부_포트</code>로 접근하시면 됩니다.</p><h2 id=컨테이너-빌드>컨테이너 빌드</h2><p>Docker 컨테이너 배포를 위해 배포하고자 하는 프로젝트를 컨테이너 이미지로 빌드해야합니다.</p><h3 id=프로젝트-빌드>프로젝트 빌드</h3><p>일반적으로 Docker 컨테이너를 빌드할 때 이미지 크기 및 빌드 시간 최적화를 위해 실행 가능한 애플리케이션만을 이미지에 포함해 빌드합니다.</p><p>실습 같은 Spring boot 프로젝트 같은 경우 빌드를 완료한 후 생성되는 실행 파일인 <code>.jar</code> 파일만을 포함하는 것을 의미합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>./gradlew build
</span></span></code></pre></td></tr></table></div></div><p>해당 명령을 실행하여 프로젝트를 빌드하면 아래와 같은 구조로 빌드 결과물들이 나옵니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── classes
</span></span><span class=line><span class=cl>│   └── kotlin
</span></span><span class=line><span class=cl>├── generated
</span></span><span class=line><span class=cl>│   └── source
</span></span><span class=line><span class=cl>├── kotlin
</span></span><span class=line><span class=cl>│   ├── compileKotlin
</span></span><span class=line><span class=cl>│   ├── compileTestKotlin
</span></span><span class=line><span class=cl>│   ├── kaptGenerateStubsKotlin
</span></span><span class=line><span class=cl>│   └── kaptGenerateStubsTestKotlin
</span></span><span class=line><span class=cl>├── libs
</span></span><span class=line><span class=cl>│   ├── &lt;프로젝트명&gt;-&lt;build.gradle에 설정한 버전&gt;-plain.jar
</span></span><span class=line><span class=cl>│   └── &lt;프로젝트명&gt;-&lt;build.gradle에 설정한 버전&gt;.jar
</span></span><span class=line><span class=cl>├── reports
</span></span><span class=line><span class=cl>│   └── tests
</span></span><span class=line><span class=cl>├── resolvedMainClassName
</span></span><span class=line><span class=cl>├── resources
</span></span><span class=line><span class=cl>│   └── main
</span></span><span class=line><span class=cl>├── snapshot
</span></span><span class=line><span class=cl>│   └── kotlin
</span></span><span class=line><span class=cl>├── test-results
</span></span><span class=line><span class=cl>│   └── test
</span></span><span class=line><span class=cl>└── tmp
</span></span><span class=line><span class=cl>    ├── bootJar
</span></span><span class=line><span class=cl>    ├── jar
</span></span><span class=line><span class=cl>    ├── kapt3
</span></span><span class=line><span class=cl>    └── test
</span></span></code></pre></td></tr></table></div></div><p>Gradle 같은 경우 별도 설정을 하지 않았다면 <code>build/libs</code> 디렉터리에 <code>&lt;프로젝트명>-&lt;build.gradle에 설정한 버전></code> 형태로 실행 파일을 만듭니다.</p><blockquote><p>Plain JAR는 애플리케이션 코드만을 JAR 파일로 패키징 하는 방식으로 배포되는 파일의 크기가 작지만, 실행 시에 종속성을 관리해야 하는 번거로움이 있습니다.</p></blockquote><p>일반적으로 SpringBoot 애플리케이션을 빌드할 때는 Fat JAR 방식으로 종속성을 내장하여 실행 가능한 형태로 배포하므로 Fat JAR를 컨테이너 이미지에 포함하면 됩니다.</p><blockquote><p>지금은 직접 명령어를 통해서 프로젝트를 빌드하고 있지만, CI/CD 통해 변경된 내용을 반영하고 빌드해서 배포하는 과정을 자동화할 수 있습니다.</p></blockquote><h3 id=dockerfile-작성>Dockerfile 작성</h3><p>Dockerfile은 Docker 컨테이너 이미지를 빌드하기 위해 필요한 명령과 필요한 환경 변수 등을 기술한 텍스트 파일입니다.</p><p>Docker 이미지는 실행 가능한 애플리케이션과 해당 애플리케이션을 실행하는 데 필요한 모든 환경 및 종속성을 포함하는데, Dockerfile을 통해 이미지를 어떻게 구성하고 빌드해야 하는지에 대한 명령을 정의할 수 있습니다.</p><p>Dockerfile을 프로젝트 최상위 디렉터리에 만들고 <code>docker build</code> 명령을 실행하면 작성 내용에 맞춰 빌드 작업을 수행하게 됩니다.</p><p>그럼 간단하게 Dockerfile을 작성해보겠습니다. 위에서 언급한 것처럼 애플리케이션을 직접 실행할 수 있는 항목들만 컨테이너에 기술해주면 됩니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> bellsoft/liberica-runtime-container:jre-17-slim-musl</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> build/libs/*.jar app/app.jar<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;java&#34;</span><span class=p>,</span> <span class=s2>&#34;-jar&#34;</span><span class=p>,</span><span class=s2>&#34;/app/app.jar&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>Dockerfile을 해석해보면</p><ul><li><code>FROM</code>: 베이스 이미지를 선택합니다. Ubuntu 기반 Java 17 런타임 환경 이미지인 <code>bellsoft/liberica-runtime-container:jre-17-slim-musl</code>로 설정하였습니다.<ul><li>베이스 이미지는 <a class=link href=https://hub.docker.com/ target=_blank rel=noopener>Docker Hub</a> 에서 찾아볼 수 있고, 저는 jre 17 중 가장 용량이 작은 이미지로 선택했습니다.</li><li>기본적인 환경이 구성된 이미지는 대부분 Docker Hub에서 찾을 수 있고 해당 이미지의 이미지 레이어도 확인 가능합니다.</li></ul></li><li><code>COPY</code>: 호스트 시스템의 디렉터리에서 컨테이너 내부 지정 위치로 복사합니다.<ul><li>Java 실행파일을 컨테이너 환경 최상위 디렉터리에 <code>app.jar</code> 이름으로 복사하게 됩니다.</li></ul></li><li><code>ENTRYPOINT</code>: 컨테이너가 실행될 때 실행할 명령어를 정의합니다.<ul><li><code>ENTRYPOINT</code>는 <code>CMD</code>로 대체할 수도 있는데 명령어가 실행되는 방식이 조금 다릅니다. 이는 추후에 다뤄보겠습니다.</li></ul></li></ul><h3 id=docker-이미지-빌드>Docker 이미지 빌드</h3><p>이제 Docker 이미지를 빌드해보겠습니다. 기본 사용법은 아래와 같습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker build <span class=o>[</span>OPTIONS<span class=o>]</span> PATH <span class=p>|</span> URL <span class=p>|</span> -
</span></span></code></pre></td></tr></table></div></div><p>여러 옵션이 있지만 <code>-t</code>(<code>--tag</code>) 옵션을 사용하여 이름과 태그를 설정할 수 있습니다. <code>이름:태그</code> 형식으로 작성하고, 태그는 생략될 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker build -t &lt;이미지 이름:태그&gt; &lt;Dockerfile이 위치한 디렉터리 경로&gt;
</span></span></code></pre></td></tr></table></div></div><hr><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zed data-lang=zed><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span><span class=w> </span><span class=n>Building</span><span class=w> </span><span class=err>9</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w> </span><span class=p>(</span><span class=err>8</span><span class=o>/</span><span class=err>8</span><span class=p>)</span><span class=w> </span><span class=n>FINISHED</span><span class=w>                                                                                                                   
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=n>internal</span><span class=p>]</span><span class=w> </span><span class=n>load</span><span class=w> </span><span class=n>build</span><span class=w> </span><span class=kt>definition</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>Dockerfile</span><span class=w>                                                                                          </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>transferring</span><span class=w> </span><span class=n>dockerfile</span><span class=o>:</span><span class=w> </span><span class=err>281</span><span class=n>B</span><span class=w>                                                                                                          </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=n>internal</span><span class=p>]</span><span class=w> </span><span class=n>load</span><span class=w> </span><span class=p>.</span><span class=n>dockerignore</span><span class=w>                                                                                                             </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>transferring</span><span class=w> </span><span class=n>context</span><span class=o>:</span><span class=w> </span><span class=err>2</span><span class=n>B</span><span class=w>                                                                                                               </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=n>internal</span><span class=p>]</span><span class=w> </span><span class=n>load</span><span class=w> </span><span class=n>metadata</span><span class=w> </span><span class=n>for</span><span class=w> </span><span class=n>docker</span><span class=p>.</span><span class=nn>io/bellsoft/</span><span class=n>liberica</span><span class=o>-</span><span class=n>runtime</span><span class=o>-</span><span class=n>container</span><span class=o>:</span><span class=n>jre</span><span class=o>-</span><span class=err>17</span><span class=o>-</span><span class=n>slim</span><span class=o>-</span><span class=n>musl</span><span class=w>                                               </span><span class=err>2</span><span class=p>.</span><span class=err>6</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=n>auth</span><span class=p>]</span><span class=w> </span><span class=nn>bellsoft/</span><span class=n>liberica</span><span class=o>-</span><span class=n>runtime</span><span class=o>-</span><span class=n>container</span><span class=o>:</span><span class=n>pull</span><span class=w> </span><span class=n>token</span><span class=w> </span><span class=n>for</span><span class=w> </span><span class=n>registry</span><span class=o>-</span><span class=err>1</span><span class=p>.</span><span class=n>docker</span><span class=p>.</span><span class=n>io</span><span class=w>                                                            </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=n>internal</span><span class=p>]</span><span class=w> </span><span class=n>load</span><span class=w> </span><span class=n>build</span><span class=w> </span><span class=n>context</span><span class=w>                                                                                                             </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>transferring</span><span class=w> </span><span class=n>context</span><span class=o>:</span><span class=w> </span><span class=err>344</span><span class=n>B</span><span class=w>                                                                                                             </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=err>1</span><span class=o>/</span><span class=err>2</span><span class=p>]</span><span class=w> </span><span class=n>FROM</span><span class=w> </span><span class=n>docker</span><span class=p>.</span><span class=nn>io/bellsoft/</span><span class=n>liberica</span><span class=o>-</span><span class=n>runtime</span><span class=o>-</span><span class=n>container</span><span class=o>:</span><span class=n>jre</span><span class=o>-</span><span class=err>17</span><span class=o>-</span><span class=n>slim</span><span class=o>-</span><span class=n>musl</span><span class=err>@</span><span class=n>sha256</span><span class=o>:</span><span class=err>95</span><span class=n>ebc03f0f27568a915cc2616a8e9f12e3eb33f4c3197c71606c186</span><span class=w>  </span><span class=err>6</span><span class=p>.</span><span class=err>1</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>resolve</span><span class=w> </span><span class=n>docker</span><span class=p>.</span><span class=nn>io/bellsoft/</span><span class=n>liberica</span><span class=o>-</span><span class=n>runtime</span><span class=o>-</span><span class=n>container</span><span class=o>:</span><span class=n>jre</span><span class=o>-</span><span class=err>17</span><span class=o>-</span><span class=n>slim</span><span class=o>-</span><span class=n>musl</span><span class=err>@</span><span class=n>sha256</span><span class=o>:</span><span class=err>95</span><span class=n>ebc03f0f27568a915cc2616a8e9f12e3eb33f4c3197c71606c186</span><span class=w>  </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>sha256</span><span class=o>:</span><span class=err>95</span><span class=n>ebc03f0f27568a915cc2616a8e9f12e3eb33f4c3197c71606c186e84096969</span><span class=w> </span><span class=err>529</span><span class=n>B</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>529</span><span class=n>B</span><span class=w>                                                    </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>sha256</span><span class=o>:</span><span class=err>216</span><span class=n>addf7a20c81782208e43c78219ebf492c4ac44dc6ebd2fa4f04b7fe5573c9</span><span class=w> </span><span class=err>1</span><span class=p>.</span><span class=err>77</span><span class=n>kB</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>1</span><span class=p>.</span><span class=err>77</span><span class=n>kB</span><span class=w>                                                </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>sha256</span><span class=o>:</span><span class=n>a53839d7740238f431dd368e69ab2fde8df89f7fe7df9fc1f1bb50aa59ccd6a1</span><span class=w> </span><span class=err>39</span><span class=p>.</span><span class=err>73</span><span class=n>MB</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>39</span><span class=p>.</span><span class=err>73</span><span class=n>MB</span><span class=w>                                              </span><span class=err>5</span><span class=p>.</span><span class=err>1</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>extracting</span><span class=w> </span><span class=n>sha256</span><span class=o>:</span><span class=n>a53839d7740238f431dd368e69ab2fde8df89f7fe7df9fc1f1bb50aa59ccd6a1</span><span class=w>                                                     </span><span class=err>0</span><span class=p>.</span><span class=err>9</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>[</span><span class=err>2</span><span class=o>/</span><span class=err>2</span><span class=p>]</span><span class=w> </span><span class=n>COPY</span><span class=w> </span><span class=nn>build/libs/</span><span class=o>*</span><span class=p>.</span><span class=n>jar</span><span class=w> </span><span class=nn>app/</span><span class=n>app</span><span class=p>.</span><span class=n>jar</span><span class=w>                                                                                                   </span><span class=err>0</span><span class=p>.</span><span class=err>1</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>exporting</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>image</span><span class=w>                                                                                                                        </span><span class=err>0</span><span class=p>.</span><span class=err>1</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>exporting</span><span class=w> </span><span class=n>layers</span><span class=w>                                                                                                                       </span><span class=err>0</span><span class=p>.</span><span class=err>1</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>writing</span><span class=w> </span><span class=n>image</span><span class=w> </span><span class=n>sha256</span><span class=o>:</span><span class=err>9830437234</span><span class=n>c832dc3ad45e9833a27e89449889296bdf9ec9091f6680d648d8a8</span><span class=w>                                                  </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>naming</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>docker</span><span class=p>.</span><span class=nn>io/library/</span><span class=n>kt</span><span class=o>-</span><span class=n>spring</span><span class=o>-</span><span class=n>docker</span><span class=o>-</span><span class=n>edit</span><span class=w>                                                                                      </span><span class=err>0</span><span class=p>.</span><span class=err>0</span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Use</span><span class=w> </span><span class=err>&#39;</span><span class=n>docker</span><span class=w> </span><span class=n>scan</span><span class=err>&#39;</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>run</span><span class=w> </span><span class=n>Snyk</span><span class=w> </span><span class=n>tests</span><span class=w> </span><span class=n>against</span><span class=w> </span><span class=n>images</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>find</span><span class=w> </span><span class=n>vulnerabilities</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>learn</span><span class=w> </span><span class=n>how</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>fix</span><span class=w> </span><span class=n>them</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>저는 <code>kt-spring-docker</code>로 이름을 설정하고 태그는 설정하지 않았습니다. 명령어를 실행하면 위와 같은 형식으로 빌드 과정을 출력합니다.</p><p>결과는 <code>docker images</code> 명령으로 확인할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker images
</span></span></code></pre></td></tr></table></div></div><hr><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>REPOSITORY                     TAG       IMAGE ID       CREATED          SIZE
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>kt-spring-docker-edit          latest    9830437234c8   7 minutes ago    164MB
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><h2 id=컨테이너-배포>컨테이너 배포</h2><p>컨테이너 배포를 위한 기본 명령어는 아래와 같습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run <span class=o>[</span>OPTIONS<span class=o>]</span> IMAGE <span class=o>[</span>COMMAND<span class=o>]</span> <span class=o>[</span>ARG...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>다양한 옵션이 존재하지만 그 중 <code>-p</code>(<code>--publish</code>) 옵션은 호스트 포트와 컨테이너 포트를 연결하여 컨테이너를 실행할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run -p &lt;호스트_포트번호:컨테이너_포트번호&gt; &lt;컨테이너 식별자&gt;
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>WARNING: The requested image&#39;s platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  .   ____          _            __ _ _
</span></span><span class=line><span class=cl> /\\ / ___&#39;_ __ _ _(_)_ __  __ _ \ \ \ \
</span></span><span class=line><span class=cl>( ( )\___ | &#39;_ | &#39;_| | &#39;_ \/ _` | \ \ \ \
</span></span><span class=line><span class=cl> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
</span></span><span class=line><span class=cl>  &#39;  |____| .__|_| |_|_| |_\__, | / / / /
</span></span><span class=line><span class=cl> =========|_|==============|___/=/_/_/_/
</span></span><span class=line><span class=cl> :: Spring Boot ::                (v3.1.2)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2023-08-30T17:29:41.102Z  INFO 1 --- [           main] c.m.k.KotlinTutorialApplicationKt        : Starting KotlinTutorialApplicationKt v0.0.1-SNAPSHOT using Java 17.0.8 with PID 1 (/app/app.jar started by root in /)
</span></span><span class=line><span class=cl>2023-08-30T17:29:41.124Z  INFO 1 --- [           main] c.m.k.KotlinTutorialApplicationKt        : No active profile set, falling back to 1 default profile: &#34;default&#34;
</span></span><span class=line><span class=cl>2023-08-30T17:29:46.689Z  INFO 1 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
</span></span><span class=line><span class=cl>2023-08-30T17:29:47.122Z  INFO 1 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 375 ms. Found 2 JPA repository interfaces.
</span></span><span class=line><span class=cl>2023-08-30T17:29:51.800Z  INFO 1 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
</span></span><span class=line><span class=cl>2023-08-30T17:29:51.850Z  INFO 1 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
</span></span><span class=line><span class=cl>2023-08-30T17:29:51.851Z  INFO 1 --- [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.11]
</span></span><span class=line><span class=cl>2023-08-30T17:29:52.320Z  INFO 1 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
</span></span><span class=line><span class=cl>2023-08-30T17:29:52.334Z  INFO 1 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 10170 ms
</span></span><span class=line><span class=cl>2023-08-30T17:29:53.238Z  INFO 1 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
</span></span><span class=line><span class=cl>2023-08-30T17:29:54.047Z  INFO 1 --- [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:71313eab-1da9-46b3-bcd5-df59c1121b0b user=SA
</span></span><span class=line><span class=cl>2023-08-30T17:29:54.057Z  INFO 1 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
</span></span><span class=line><span class=cl>2023-08-30T17:29:54.322Z  INFO 1 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
</span></span><span class=line><span class=cl>2023-08-30T17:29:54.538Z  INFO 1 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.6.Final
</span></span><span class=line><span class=cl>2023-08-30T17:29:54.576Z  INFO 1 --- [           main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
</span></span><span class=line><span class=cl>2023-08-30T17:29:55.140Z  INFO 1 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
</span></span><span class=line><span class=cl>2023-08-30T17:29:56.491Z  INFO 1 --- [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
</span></span><span class=line><span class=cl>2023-08-30T17:29:58.111Z  INFO 1 --- [           main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
</span></span><span class=line><span class=cl>2023-08-30T17:30:01.316Z  INFO 1 --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
</span></span><span class=line><span class=cl>2023-08-30T17:30:01.550Z  INFO 1 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit &#39;default&#39;
</span></span><span class=line><span class=cl>2023-08-30T17:30:04.136Z  WARN 1 --- [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
</span></span><span class=line><span class=cl>2023-08-30T17:30:06.776Z  INFO 1 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path &#39;&#39;
</span></span><span class=line><span class=cl>2023-08-30T17:30:06.861Z  INFO 1 --- [           main] c.m.k.KotlinTutorialApplicationKt        : Started KotlinTutorialApplicationKt in 28.216 seconds (process running for 31.678)
</span></span><span class=line><span class=cl>2023-08-30T17:30:47.268Z  INFO 1 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet &#39;dispatcherServlet&#39;
</span></span><span class=line><span class=cl>2023-08-30T17:30:47.272Z  INFO 1 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet &#39;dispatcherServlet&#39;
</span></span><span class=line><span class=cl>2023-08-30T17:30:47.288Z  INFO 1 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 14 ms
</span></span></code></pre></td></tr></table></div></div><p><code>docker ps</code> 명령을 통해 현재 실행 중인 컨테이너를 확인할 수 있고, 앞서 설명해 드린 외부 IP를 통해 접근해보면 정상적으로 배포된 것을 확인할 수 있습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker ps
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE                     COMMAND                  CREATED             STATUS             PORTS                    NAMES
</span></span><span class=line><span class=cl>9d85dbbbf374   kt-spring-docker-edit-2   &#34;java -jar /app/app.…&#34;   About an hour ago   Up About an hour   0.0.0.0:8080-&gt;8080/tcp   bold_chaum
</span></span></code></pre></td></tr></table></div></div><p><img src=/post/infra/container-env/1/img_2.png width=413 height=895 srcset="/post/infra/container-env/1/img_2_huad70b1356626920c39dc8d86163420b4_30925_480x0_resize_box_3.png 480w, /post/infra/container-env/1/img_2_huad70b1356626920c39dc8d86163420b4_30925_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=46 data-flex-basis=110px></p></section><footer class=article-footer><section class=article-tags><a href=/tags/docker/>Docker</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><div class="article-list--compact links"><article><a href=https://product.kyobobook.co.kr/detail/S000001834629 target=_blank rel=noopener><div class=article-details><h2 class=article-title>컨테이너 인프라 환경 구축을 위한 쿠버네티스/도커</h2><footer class=article-time>https://product.kyobobook.co.kr/detail/S000001834629</footer></div></a></article><article><a href=https://docs.docker.com/desktop/install/mac-install/ target=_blank rel=noopener><div class=article-details><h2 class=article-title>Install Docker Desktop</h2><footer class=article-time>https://docs.docker.com/desktop/install/mac-install/</footer></div></a></article></div><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/kubernetes/tutorials/1/><div class=article-image><img src=/post/kubernetes/tutorials/1/cover.8a7111ac770762d16c23051c45b32b7b_hu15504362c54454204bbf321d3bfe3873_12586_250x150_fill_q75_h2_box_smart1_2.webp width=250 height=150 loading=lazy alt="Featured image of post 쿠버네티스 튜토리얼 - 1. Hello Minikube" data-key=kubernetes/tutorials/1 data-hash="md5-inERrHcHYtFsIwUcRbMrew=="></div><div class=article-details><h2 class=article-title>쿠버네티스 튜토리얼 - 1. Hello Minikube</h2></div></a></article><article class=has-image><a href=/post/docker/5/><div class=article-image><img src=/post/docker/5/docker_cover.9b647cf4f27c2e9eb7be49f9f4c31e93_hue12353db563619e41ee3a11307d3cf25_62602_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 5. Use bind mounts" data-key=docker/5 data-hash="md5-m2R89PJ8Lp63vkn59MMekw=="></div><div class=article-details><h2 class=article-title>5. Use bind mounts</h2></div></a></article><article class=has-image><a href=/post/docker/4/><div class=article-image><img src=/post/docker/4/docker_cover.9b647cf4f27c2e9eb7be49f9f4c31e93_hue12353db563619e41ee3a11307d3cf25_62602_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 4. Persist the DB" data-key=docker/4 data-hash="md5-m2R89PJ8Lp63vkn59MMekw=="></div><div class=article-details><h2 class=article-title>4. Persist the DB</h2></div></a></article><article class=has-image><a href=/post/docker/3/><div class=article-image><img src=/post/docker/3/docker_cover.9b647cf4f27c2e9eb7be49f9f4c31e93_hue12353db563619e41ee3a11307d3cf25_62602_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 3. Share the application" data-key=docker/3 data-hash="md5-m2R89PJ8Lp63vkn59MMekw=="></div><div class=article-details><h2 class=article-title>3. Share the application</h2></div></a></article><article class=has-image><a href=/post/docker/2/><div class=article-image><img src=/post/docker/2/docker_cover.9b647cf4f27c2e9eb7be49f9f4c31e93_hue12353db563619e41ee3a11307d3cf25_62602_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 2. Update the application" data-key=docker/2 data-hash="md5-m2R89PJ8Lp63vkn59MMekw=="></div><div class=article-details><h2 class=article-title>2. Update the application</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=codemario318/codemario318.github.io issue-term=pathname label=Comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2024 Mario Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>