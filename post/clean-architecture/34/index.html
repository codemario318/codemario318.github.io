<!doctype html><html lang=ko dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="6부 - 세부사항"><title>34. 빠져있는 장: By Simon Brown</title><link rel=canonical href=https://codemario318.github.io/post/clean-architecture/34/><link rel=stylesheet href=/scss/style.min.cbce94e2760d14d60414e59d5a36ab2819232375817e010dbe7be2234b67da1b.css><meta property="og:title" content="34. 빠져있는 장: By Simon Brown"><meta property="og:description" content="6부 - 세부사항"><meta property="og:url" content="https://codemario318.github.io/post/clean-architecture/34/"><meta property="og:site_name" content="Mario Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Clean Architecture"><meta property="article:tag" content="클린 아키텍처"><meta property="article:tag" content="설계"><meta property="article:tag" content="Design"><meta property="article:tag" content="소프트웨어 설계"><meta property="article:tag" content="Software Design"><meta property="article:tag" content="아키텍처"><meta property="article:tag" content="Architecture"><meta property="article:tag" content="소프트웨어 아키텍처"><meta property="article:tag" content="Software Architecture"><meta property="article:published_time" content="2024-04-19T15:59:13+09:00"><meta property="article:modified_time" content="2024-04-19T15:59:13+09:00"><meta property="og:image" content="https://codemario318.github.io/post/clean-architecture/34/cover.png"><meta name=twitter:title content="34. 빠져있는 장: By Simon Brown"><meta name=twitter:description content="6부 - 세부사항"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codemario318.github.io/post/clean-architecture/34/cover.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-K99591YLGK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K99591YLGK",{anonymize_ip:!1})}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3183752545292673" crossorigin=anonymous></script><meta name=naver-site-verification content="2315bde85c86f66092140cc465c340a2170f3187"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu760fd15c5fbb2f30cf0868dc4a5dc41a_14271_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Mario Blog</a></h1><h2 class=site-description></h2></div></header><ol class=social-menu><li><a href=https://github.com/codemario318 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><ul class="menu sub-menu"><li><a href=/categories/backend/><span>Backend</span>
<span class=content-count>3</span></a></li><li><a href=/categories/boostcamp/><span>부스트캠프</span>
<span class=content-count>11</span></a></li><li><a href=/categories/cleancode/><span>Clean Code</span>
<span class=content-count>10</span></a></li><li><a href=/categories/common/><span>Common</span>
<span class=content-count>68</span></a></li><li><a href=/categories/data/><span>Data</span>
<span class=content-count>3</span></a></li><li><a href=/categories/db/><span>DB</span>
<span class=content-count>1</span></a></li><li><a href=/categories/frontend/><span>Frontend</span>
<span class=content-count>10</span></a></li><li><a href=/categories/golang/><span>GoLang</span>
<span class=content-count>13</span></a></li><li><a href=/categories/headfirstdesignpatterns/><span>헤드 퍼스트 디자인 패턴</span>
<span class=content-count>22</span></a></li><li><a href=/categories/infra/><span>Infra</span>
<span class=content-count>14</span></a></li><li><a href=/categories/nest/><span>Nest</span>
<span class=content-count>1</span></a></li><li><a href=/categories/network/><span>네트워크</span>
<span class=content-count>1</span></a></li><li><a href=/categories/node/><span>Node</span>
<span class=content-count>1</span></a></li><li><a href=/categories/problemsolving/><span>Problem Solving</span>
<span class=content-count>1</span></a></li><li><a href=/categories/project/><span>Project</span>
<span class=content-count>5</span></a></li><li><a href=/categories/realmysql/><span>Real MySQL</span>
<span class=content-count>53</span></a></li></ul><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#계층-기반-패키지>계층 기반 패키지</a></li><li><a href=#기능-기반-패키지>기능 기반 패키지</a></li><li><a href=#포트와-어댑터>포트와 어댑터</a></li><li><a href=#컴포넌트-기반-패키지>컴포넌트 기반 패키지</a></li><li><a href=#구현-세부사항엔-항상-문제가-있다>구현 세부사항엔 항상 문제가 있다.</a><ol><li><a href=#조직화-vs-캡슐화>조직화 VS 캡슐화</a></li></ol></li><li><a href=#다른-결합-분리-모드>다른 결합 분리 모드</a></li><li><a href=#결론-빠져있는-조언>결론: 빠져있는 조언</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/clean-architecture/34/><img src=/post/clean-architecture/34/cover_hu01783d23203014d58ee585db2e3121c4_1011761_800x0_resize_box_3.png srcset="/post/clean-architecture/34/cover_hu01783d23203014d58ee585db2e3121c4_1011761_800x0_resize_box_3.png 800w, /post/clean-architecture/34/cover_hu01783d23203014d58ee585db2e3121c4_1011761_1600x0_resize_box_3.png 1600w" width=800 height=1043 loading=lazy alt="Featured image of post 34. 빠져있는 장: By Simon Brown"></a></div><div class=article-details><header class=article-category><a href=/categories/common/ style=background-color:#2a9d8f;color:#fff>Common</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/clean-architecture/34/>34. 빠져있는 장: By Simon Brown</a></h2><h3 class=article-subtitle>6부 - 세부사항</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2024/04/19</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>8 minute read</time></div></footer></div></header><section class=article-content><p>지금까지 읽은 모든 조언을 통해 올바르게 정의된 경계, 명확한 책임, 통제된 의존성을 가진 클래스와 컴포넌트로 구성된 좋은 소프트웨어를 설계할 수 있다.</p><p>하지만 실제 적용에서는 <strong>디테일</strong>(구현 세부사항)을 심사숙고하지 않는다면 마지막 고비에 걸려 넘어지기 십상이다.</p><h2 id=계층-기반-패키지>계층 기반 패키지</h2><p>가장 단순한 설계 방식으로 <strong>전통적인 수평 계층형 아키텍처</strong>가 있다.</p><p><strong>계층 기반 패키지</strong>라고도 불리는 이 방법은 기술적인 관점에서 해당 코드가 하는 일에 기반해 그 코드를 분할한다.</p><p>이러한 전형적인 계층형 아키텍처에는 웹, 업무 규칙, 영속성 코드를 위해 계층이 각각 하나씩 존재한다.</p><p>코드는 계층이라는 얇은 수평 조각으로 나뉘며, 각 계층은 유사한 종류의 것들을 묶는 도구로 사용된다.</p><ul><li>엄격한 계층형 아키텍처의 경우 계층은 반드시 바로 아래 계층에만 의존해야한다.</li></ul><p><img src=/post/clean-architecture/34/img.png width=635 height=674 srcset="/post/clean-architecture/34/img_hu09d1a64cd1e72f2d69d142c6a608bf93_75674_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img_hu09d1a64cd1e72f2d69d142c6a608bf93_75674_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=94 data-flex-basis=226px></p><ul><li><code>OrdersController</code><ul><li>웹 컨트롤러이며, 웹 기반 요청을 처리한다.</li><li>ex) Spring MVC 컨트롤러 등</li></ul></li><li><code>OrdersService</code><ul><li>주문 관련 업무 규칙을 정의하는 인터페이스</li></ul></li><li><code>OrdersServiceImpl</code><ul><li><code>OrdersService</code>의 구현체</li></ul></li><li><code>OrdersRepository</code><ul><li>영구 저장된 주문 정보에 접근하는 방법을 정의하는 인터페이스</li></ul></li><li><code>JdbcOrdersRepository</code><ul><li><code>OrdersRespository</code>의 구현체</li></ul></li></ul><p>마틴 파울러는 <strong>프레젠테이션 도메인 데이터</strong> 계층화에서 처음 시작하기에는 계층형 아키텍처가 적합하다고 언급한다.</p><ul><li>엄청난 복잡함을 겪지 않고도 무언가를 작동시켜 주는 아주 빠른 방법이다.</li><li>소프트웨어가 커지고 복잡해지기 시작하면 세 개의 계층으로만은 부족하다 느끼고 더 잘게 모듈화 해야할 필요성을 느낄 수 있다.</li><li>업무 도메인에 대해 아무것도 말해주지 않는다.</li></ul><h2 id=기능-기반-패키지>기능 기반 패키지</h2><p><strong>기능 기반 패키지</strong> 구조는 서로 연관된 기능, 도메인 개념, (도메인 주도 설계 용어를 자주 사용한다면) Aggregate Root에 기반하여 수직의 얇은 조각으로 코드를 나누는 방식이다.</p><p><img src=/post/clean-architecture/34/img2.png width=627 height=670 srcset="/post/clean-architecture/34/img2_hub33c374a47ec3a9ae590abdd19e1dc17_60523_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img2_hub33c374a47ec3a9ae590abdd19e1dc17_60523_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=93 data-flex-basis=224px></p><p>인터페이스와 클래스는 이전과 같지만, 모두가 단 하나의 패키지에 속하게 된다.</p><ul><li>이는 <strong>계층 기반 패키지</strong>를 아주 간단히 리팩터링한 형태지만 코드의 상위 수준 구조가 업무 도메인에 대해 무언가를 알려주게된다.</li><li>유스케이스가 변경될 경우 변경해야 할 코드를 모두 찾는 작업이 더 쉬워질 수 있다.</li></ul><p>소프트웨어 개발팀이 수평적 계층화의 문제를 깨닫고, 수직적 계층화로 전환하는 경우가 많지만, 두 접근법 모두 차선책이다.</p><h2 id=포트와-어댑터>포트와 어댑터</h2><p>포트와 어댑터(Ports and Adapters) 혹은 육각형 아키텍처(Hexagonal Architecture), 경계, 컨트롤러, 엔티티(BCE) 등의 방식으로 접근하는 이유는 업무/도메인에 초점을 둔 코드가 프레임워크나 데이터베이스 같은 기술적인 세부 구현과 독립적이며 분리된 아키텍처를 만들기 위해서다.</p><p>그런 코드 베이스는 **내부(도메인)**와 **외부(인프라)**로 구성됨을 흔히 볼 수 있다.</p><p><img src=/post/clean-architecture/34/img3.png width=633 height=485 srcset="/post/clean-architecture/34/img3_hub97e2c2908d969078290a6c0afd4246d_67211_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img3_hub97e2c2908d969078290a6c0afd4246d_67211_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=130 data-flex-basis=313px></p><ul><li>내부 영역<ul><li>도메인 개념을 모두 포함한다.</li></ul></li><li>외부 영역<ul><li>외부 세계(UI, DB, 서드파티 통합)와의 상호작용을 포함한다.</li></ul></li></ul><p><strong>외부가 내부에 의존하며, 절대 그 반대로는 안된다.</strong></p><p><img src=/post/clean-architecture/34/img4.png width=632 height=669 srcset="/post/clean-architecture/34/img4_hu067ed2819602a97a65ad3f6557f29a26_73442_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img4_hu067ed2819602a97a65ad3f6557f29a26_73442_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=94 data-flex-basis=226px></p><p>위 구조에서 <code>com.mycompany.myapp.domain</code> 패키지가 내부이며, 나머지 패키지는 모두 외부이다.</p><p><code>OrdersRepository</code>가 <code>Orders</code>라는 간단한 이름으로 바뀌었는데, 이는 도메인 주도 설계라는 세계관에서 비롯된 명명법으로, <strong>내부</strong>에 존재하는 모든 것의 이름은 반드시 <strong>유비쿼터스 도메인 언어</strong>관점에서 기술하라고 조언한다.</p><ul><li>도메인에 대하 논의할 때 <strong>주문</strong>에 대해 말하는 것이지 <strong>주문 리포지토리</strong>에 대해 말하는 것이 아니기 때문</li></ul><h2 id=컴포넌트-기반-패키지>컴포넌트 기반 패키지</h2><p>SOLID, REP, CCP, CRP 같은 이 책에 대다수의 조언은 당연히 중요하지만, 코드를 조직화하는 방법에 대해서는 <strong>컴포넌트 기반 패키지</strong>같은 접근 방법을 적용해 볼 수 있다.</p><p><strong>계층형 아키텍처의 단점</strong></p><p>계층형 아키텍처의 목적은 기능이 같은 코드끼리 서로 분리하는 것이다.</p><p>구현 관점에서 보면 각 계층은 일반적으로 자바 패키지에 해당하며 서로 다른 패키지에 속한다. 따라서 코드의 접근성 관점에서 살펴보면 아래와 같은 문제가 있다.</p><ul><li><code>OrdersController</code>가 <code>OrdersService</code> 인터페이스에 의존하려면 <code>OrdersService</code> 인터페이스는 반드시 <code>public</code>으로 선언되어야 한다.</li><li><code>OrdersRepository</code> 인터페이스도 <code>public</code>이어야만 <code>repository</code> 패키지 외부에 있는 <code>OrdersServiceImpl</code> 클래스에 접근할 수 있다.</li></ul><p>엄격한 계층형 아키텍처에서 의존성 화살표는 항상 아래를 향해야 하므로, 깔끔한 비순환 의존성 그래프를 만들 수 있을 것이라 생각할 수 있지만, 실제로는 코드 베이스의 요소들이 서로를 의존할 때는 몇 가지 규칙을 반드시 지켜야한다.</p><p>여기서 큰 문제는, 속임수를 써서 의존성을 의도치 않은 방식으로 추가하더라도 보기에는 여전히 좋은 비순환 의존성 그래프가 생성된다.</p><p><img src=/post/clean-architecture/34/img_1.png width=629 height=671 srcset="/post/clean-architecture/34/img_1_hue2c4f507d4fc8ef9fe870f9d5a52a08a_68784_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img_1_hue2c4f507d4fc8ef9fe870f9d5a52a08a_68784_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=93 data-flex-basis=224px></p><p>위 상황처럼 <code>OrdersController</code>가 <code>OrdersService</code>를 우회하여 직접 <code>OrdersRepository</code>에 의존성을 가지게 하더라도 비순환 의존성 그래프가 만들어진다.</p><p>이러한 조직화는 인접한 계층들을 건너 뛰는 일이 허용되기 때문에 <strong>완화된 계층형 아키텍처</strong>라고 부르며, 이러한 방식은 CQRS(Command Query Responsibility Segregation) 패턴 같은 경우를 제외한다면 바람직하지 못하다.</p><p>따라서 계층형 아키텍처는 이러한 우회를 강제할 수 있는 방법이 없기 때문에 아키텍처가 지켜지기 힘들어진다.</p><p><strong>컴포넌트 기반 패키지</strong></p><p>반면 컴포넌트 기반 패키지는 컴파일러를 사용해서 아키텍처를 강제할 수 있다.</p><p>컴포넌트 기반 패키지는 큰 단위(coarse-grained)의 단일 컴포넌트와 관련된 모든 책임을 하나의 자바 패키지로 묶는데 주안점을 둔다.</p><p>이 접근법은 마이크로서비스 아키텍처가 가진 시각과 동일하게 서비스 중심적인 시각으로 소프트웨어 시스템을 바라볼 수 있다.</p><ul><li>포트와 어댑터에서 웹을 그저 또 다른 전달 메커니즘으로 취급하는 것과 마찬가지로, 사용자 인터페이스를 큰 단위의 컴포넌트로부터 분리해서 유지한다.</li></ul><p><img src=/post/clean-architecture/34/img_2.png width=628 height=668 srcset="/post/clean-architecture/34/img_2_huade6c3c558bab5a248a2fc0978ef31a2_60168_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img_2_huade6c3c558bab5a248a2fc0978ef31a2_60168_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=94 data-flex-basis=225px></p><p>컴포넌트 기반 패키지는 본질적으로 업무 로직과 영속성 관련 코드를 하나로 묶는데 이러한 단위를 컴포넌트라 부른다.</p><blockquote><p>지금까지 언급되었던 배포할 수 있는 가장 작은 단위라는 의미가 아닌 <strong>깔끔한 인터페이스로 감싸진 연관된 기능들의 묶음</strong>을 의미한다.<br>스프트웨어 시스템의 전적 구조를 컨테이너, 컴포넌트, 클래스(코드) 측면에서 계층적으로 생각하는 방법(C4 소프트웨어 아키텍처 모델)</p></blockquote><ul><li>관련된 무언가를 코딩해야 할 때 <code>**Component</code>만 둘러보면 된다.</li><li>컴포넌트 내부에서 관심사 분리는 여전히 유효하다.</li><li>따라서 업무 로직은 데이터 영속성과 분리된다.<ul><li>컴포넌트 구현과 관련된 세부사항으로, 사용자는 알 필요가 없다.</li></ul></li></ul><p>모노리틱 애플리케이션에서 컴포넌트를 잘 정의하면 마이크로서비스 아키텍처로 가기 위한 발판으로 삼을 수 있다.</p><h2 id=구현-세부사항엔-항상-문제가-있다>구현 세부사항엔 항상 문제가 있다.</h2><p>언급한 네 가지 접근법이 코드를 조직하하는 것으로 보이지만 세부사항을 잘못 구현하면 이러한 견해도 아주 빠르게 흐트러지기 시작한다.</p><ul><li>모든 타입에서 <strong>public</strong> 지시자를 사용한다는 것 제공하는 캡슐화 이점을 활용하지 않겠다는 뜻이며, 이로인해 지향아는 아키텍처 스타일을 위반하게 될 것이다.</li></ul><h3 id=조직화-vs-캡슐화>조직화 VS 캡슐화</h3><p>자바 애플리케이션에서 모든 타입을 <code>public</code>으로 지정한다면 패키지는 단순히 조직화를 위한 매커니즘(폴더와 같은 역할만)으로 전락하여 캠슐화를 위한 메커니즘이 될 수 없다.</p><ul><li>코드 베이스를 어디서도 사용할 수 있다면 패키지를 사용하는 데 따른 이점이 거의 없다.</li><li>패키지를 무시해 버리면 캡슐화나 은닉에 아무런 도움이 없으므로 최종적으로 어떤 아키텍처 스타일로 만들려고 하는지는 아무런 의미가 없어진다.</li></ul><p><img src=/post/clean-architecture/34/img_3.png width=630 height=446 srcset="/post/clean-architecture/34/img_3_hubd3840a39404a726edb0ac1a8a8a458d_77645_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img_3_hubd3840a39404a726edb0ac1a8a8a458d_77645_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=141 data-flex-basis=339px></p><p>모든 타입을 <code>public</code>으로 선언한다면 실제로 갖게 되는 것은 수평적 계층형 아키텍처를 표현하는 방법에 불과해진다.</p><hr><p>접근 지시자를 적절하게 사용하면, 타입을 패키지로 배치하는 방식에 다라서 각 타입에 접근할 수 있는 정도가 실제로 크게 달라질 수 있다.</p><p><img src=/post/clean-architecture/34/img_4.png width=631 height=487 srcset="/post/clean-architecture/34/img_4_hub59749830694f830b27427b6082c0095_105897_480x0_resize_box_3.png 480w, /post/clean-architecture/34/img_4_hub59749830694f830b27427b6082c0095_105897_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=129 data-flex-basis=310px></p><ol><li>계층 기반 패키지 접근법<ul><li><code>OrdersService</code>, <code>OrdersRepository</code> 인터페이스는 외부 패키지의 클래스로부터 자신이 속한 패키지 내부로 들어오는 의존성으로 <code>public</code> 으로 선언되어야하지만, 구체 클래스는 누구도 알 필요가 없는 구현 세부사항이므로 <code>protected</code>로 선언할 수 있다.</li></ul></li><li>기능 기반 패키지 접근법<ul><li><code>OrdersController</code>가 패키지로 들어올 수 있는 유일한 통로를 제공하므로 나머지 패키지는 <code>protected</code>로 지정할 수 있다.</li></ul></li><li>포트와 어댑터 접근법<ul><li><code>OrdersService</code>와 <code>Orders</code> 인터페이스는 외부로부터 들어오는 의존성을 가지므로 <code>public</code>으로 지정해야한다.</li><li>구현 클래스 패키지는 <code>protected</code>로 지정하며, 런타임에 의존성을 주입할 수 있다.</li></ul></li><li>컴포넌트 기반 패키지<ul><li>컨트롤러에서 <code>OrdersComponent</code> 인터페이스로 향하는 의존성을 가지며, 그 외의 모든 것은 패키지 <code>protected</code>로 지정할 수 있다.</li><li>패키지 외부의 코드에서는 <code>OrdersRepository</code> 인터페이스나 구현체를 직접 사용할 수 있는 방법이 전혀 없으므로 컴파일러를 통해 아키텍처를 강제할 수 있다.</li></ul></li></ol><p>아키텍처 원칙을 강제할 때 컴파일러의 도움을 받아 그렇게 할 수 밖에 없도록 만들어야 한다.</p><p>모든 코드가 하나의 소스 코드 트리로 존재하는 모노리틱 애플리케이션이라면 큰 도움이 될 것이다.</p><h2 id=다른-결합-분리-모드>다른 결합 분리 모드</h2><p>프로그래밍 언어가 제공하는 방법 외에도 소스 코드 의존성을 분리하는 방법은 존재할 수 있다.</p><ul><li>모듈 시스템(ex. 자바 OSGI)</li><li>소스코드 수준에서 의존성을 분리하는 방법<ul><li><strong>서로 다른 소스 코드 트리로 분리하는 방법</strong></li></ul></li></ul><h2 id=결론-빠져있는-조언>결론: 빠져있는 조언</h2><p>최적의 설계를 꾀했더라도, 구현 전략에 얽힌 복잡함을 고려하지 않으면 설계가 순식간에 망가질 수도 있다.</p><ul><li>설계를 어떻게 해야만 원하는 코드 구조로 매핑할 수 있을지</li><li>코드를 어떻게 조직화 할지</li><li>런타임과 컴파일타입에 어떤 결합 분리 모드를 적용할지</li></ul><p>위와 같은 내용을 고민해야하며, 선택사항을 열어두되 실용주의적으로 행해야한다.</p><ul><li>팀의 규모, 기술 수준, 해결책의 복잡성을 일정과 예산이라는 제약과 동시에 고려해야한다.</li><li>선택된 아키텍처 스타일을 강제하는 데 컴파일러의 도움을 받을 수 있을지 고민해야한다.</li><li>데이터 모델과 같은 다른 영역에 결합되지 않도록 주의해야한다.</li></ul><p>구현 세부사항에는 항상 문제가 있는 법이다.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/clean-architecture/>Clean Architecture</a>
<a href=/tags/%ED%81%B4%EB%A6%B0-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98/>클린 아키텍처</a>
<a href=/tags/%EC%84%A4%EA%B3%84/>설계</a>
<a href=/tags/design/>Design</a>
<a href=/tags/%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4-%EC%84%A4%EA%B3%84/>소프트웨어 설계</a>
<a href=/tags/software-design/>Software Design</a>
<a href=/tags/%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98/>아키텍처</a>
<a href=/tags/architecture/>Architecture</a>
<a href=/tags/%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98/>소프트웨어 아키텍처</a>
<a href=/tags/software-architecture/>Software Architecture</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><div class="article-list--compact links"><article><a href=https://product.kyobobook.co.kr/detail/S000001033082 target=_blank rel=noopener><div class=article-details><h2 class=article-title>클린 아키텍처: 소프트웨어 구조와 설계의 원칙</h2><footer class=article-time>살아있는 전설이 들려주는 실용적인 소프트웨어 아키텍처 원칙 | 모든 프로그래머가 읽어야 하는 필독서!</footer></div></a></article></div><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/clean-architecture/33/><div class=article-image><img src=/post/clean-architecture/33/cover.8c3d183c5f9cbadfe69a2bd0021a711c_hu01783d23203014d58ee585db2e3121c4_1011761_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 33. 사례연구: 비디오 판매" data-key=clean-architecture/33 data-hash="md5-jD0YPF+cut/mmivQAhpxHA=="></div><div class=article-details><h2 class=article-title>33. 사례연구: 비디오 판매</h2></div></a></article><article class=has-image><a href=/post/clean-architecture/32/><div class=article-image><img src=/post/clean-architecture/32/cover.8c3d183c5f9cbadfe69a2bd0021a711c_hu01783d23203014d58ee585db2e3121c4_1011761_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 32. 프레임워크는 세부사항이다" data-key=clean-architecture/32 data-hash="md5-jD0YPF+cut/mmivQAhpxHA=="></div><div class=article-details><h2 class=article-title>32. 프레임워크는 세부사항이다</h2></div></a></article><article class=has-image><a href=/post/clean-architecture/31/><div class=article-image><img src=/post/clean-architecture/31/cover.8c3d183c5f9cbadfe69a2bd0021a711c_hu01783d23203014d58ee585db2e3121c4_1011761_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 31. 웹은 세부사항이다" data-key=clean-architecture/31 data-hash="md5-jD0YPF+cut/mmivQAhpxHA=="></div><div class=article-details><h2 class=article-title>31. 웹은 세부사항이다</h2></div></a></article><article class=has-image><a href=/post/clean-architecture/30/><div class=article-image><img src=/post/clean-architecture/30/cover.8c3d183c5f9cbadfe69a2bd0021a711c_hu01783d23203014d58ee585db2e3121c4_1011761_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 30. 데이터베이스는 세부사항이다" data-key=clean-architecture/30 data-hash="md5-jD0YPF+cut/mmivQAhpxHA=="></div><div class=article-details><h2 class=article-title>30. 데이터베이스는 세부사항이다</h2></div></a></article><article class=has-image><a href=/post/clean-architecture/28/><div class=article-image><img src=/post/clean-architecture/28/cover.8c3d183c5f9cbadfe69a2bd0021a711c_hu01783d23203014d58ee585db2e3121c4_1011761_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post 28. 테스트 경계" data-key=clean-architecture/28 data-hash="md5-jD0YPF+cut/mmivQAhpxHA=="></div><div class=article-details><h2 class=article-title>28. 테스트 경계</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=codemario318/codemario318.github.io issue-term=pathname label=Comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2024 Mario Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>